<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=description content="App Engine Cache - next task is to move the uploaded objects to App Engine MemCache, so that they become accessible to services like Queue, Tasks etc."><meta name=author content="Maithilish"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-42139846-3"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-42139846-3');</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://google.com/article"},"articleSection":"tutorial","name":"GAE Cache - GWT Tutorial - CodeTab","headline":"GAE Cache - GWT Tutorial - CodeTab","url":"https://www.codetab.org/tutorial/gwt/google-app-engine/app-engine-cache/","description":"App Engine Cache - next task is to move the uploaded objects to App Engine MemCache, so that they become accessible to services like Queue, Tasks etc.","inLanguage":"en","image":"https://www.codetab.org/logo.jpg","author":"Maithilish","creator":"Maithilish","publisher":{"@type":"Organization","name":"Maithilish","url":"https://www.codetab.org/","logo":{"@type":"ImageObject","url":"https://www.codetab.org/logo.png","width":"200","height":"200"}},"copyrightHolder":"Maithilish","copyrightYear":"2019","datePublished":"2019-01-10T16:38:00+0530","dateModified":"2019-01-10T16:38:00+0530","wordCount":"925","keywords":["app engine cache","Blog"]}</script><link rel=icon href=/favicon.ico><link rel=stylesheet href=/css/vendor.min.e7fd2d89f73c680873529a110a9007503a1bda864a3a3a6c53c4eb02a54c35eb.css integrity="sha256-5/0tifc8aAhzUpoRCpAHUDob2oZKOjpsU8TrAqVMNes="><title>GAE Cache - GWT Tutorial - CodeTab</title></head><body id=top><header><nav id=navbar-main class="navbar fixed-top navbar-light navbar-expand-lg bg-white border-bottom shadow-sm"><div class=container-fluid><a class=navbar-brand href=/>Codetab</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbar aria-controls=navbar aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbar><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=/#tutorials><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/#projects><span>Projects</span></a></li><li class=nav-item><a class=nav-link href=/post><span>Posts</span></a></li><li class=nav-item><a class=nav-link href=/#about><span>About</span></a></li></ul></div></div></nav></header><div class=container-fluid><div class=row>&nbsp;</div><div class=row><aside id=sidebar class=col-md-3><div class=row><nav id=navbar-side class="bg-light text-secondary"><h4 class="text-muted bg-white pl-2">GWT Tutorial</h4><nav class="navbar navbar-light bg-white navbar-expand-md"><button class="navbar-toggler ml-auto" type=button data-toggle=collapse data-target=#bookmenu aria-controls=bookmenu aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=bookmenu><div><div id="GWT Tutorial - Complete Project - CodeTab"><div><a href=https://www.codetab.org/tutorial/gwt/introduction/ class="toc-page text-wrap text-muted">Introduction</a></div><div><a href=https://www.codetab.org/tutorial/gwt/install/ class="toc-page text-wrap text-muted">Install GWT in Eclipse</a></div><div><a href=https://www.codetab.org/tutorial/gwt/create-project/ class="toc-page text-wrap text-muted">Project Setup</a></div><div><a href=https://www.codetab.org/tutorial/gwt/gwt-project-code/ class="toc-page text-wrap text-muted">GWT Project Code</a></div><div><a href=https://www.codetab.org/tutorial/gwt/gwt-demo/ class="toc-page text-wrap text-muted">GWT Tutorial Demo</a></div></div><div class="dropdown show mt-2"><a class="no-collapse-on-click card-link toc-section text-dark" href=#tutorial-gwt-shell id=dropdownheader data-toggle=collapse aria-haspopup=true aria-expanded=false>Shell</a><div id=tutorial-gwt-shell class=collapse><a href=https://www.codetab.org/tutorial/gwt/shell/finsshell/ class="toc-page dropdown-item text-wrap text-muted">UIBinder and Custom Widget</a>
<a href=https://www.codetab.org/tutorial/gwt/shell/contentpanel/ class="toc-page dropdown-item text-wrap text-muted">TabLayoutPanel</a>
<a href=https://www.codetab.org/tutorial/gwt/shell/gwt-logging/ class="toc-page dropdown-item text-wrap text-muted">Logging</a></div></div><div class="dropdown show mt-2"><a class="no-collapse-on-click card-link toc-section text-dark" href=#tutorial-gwt-menu id=dropdownheader data-toggle=collapse aria-haspopup=true aria-expanded=false>Menu</a><div id=tutorial-gwt-menu class=collapse><a href=https://www.codetab.org/tutorial/gwt/menu/menu/ class="toc-page dropdown-item text-wrap text-muted">ClientBundle</a>
<a href=https://www.codetab.org/tutorial/gwt/menu/menu-parts/ class="toc-page dropdown-item text-wrap text-muted">Anchor</a>
<a href=https://www.codetab.org/tutorial/gwt/menu/gwt-eventbus-events/ class="toc-page dropdown-item text-wrap text-muted">EventBus</a>
<a href=https://www.codetab.org/tutorial/gwt/menu/gwt-eventbus-example/ class="toc-page dropdown-item text-wrap text-muted">EventBus Example</a></div></div><div class="dropdown show mt-2"><a class="no-collapse-on-click card-link toc-section text-dark" href=#tutorial-gwt-model id=dropdownheader data-toggle=collapse aria-haspopup=true aria-expanded=false>Modle</a><div id=tutorial-gwt-model class=collapse><a href=https://www.codetab.org/tutorial/gwt/model/model/ class="toc-page dropdown-item text-wrap text-muted">Model</a></div></div><div class="dropdown show mt-2"><a class="no-collapse-on-click card-link toc-section text-dark" href=#tutorial-gwt-content id=dropdownheader data-toggle=collapse aria-haspopup=true aria-expanded=false>Content</a><div id=tutorial-gwt-content class=collapse><a href=https://www.codetab.org/tutorial/gwt/content/content/ class="toc-page dropdown-item text-wrap text-muted">GWT Tutorial - Content</a>
<a href=https://www.codetab.org/tutorial/gwt/content/gwt-celltable/ class="toc-page dropdown-item text-wrap text-muted">CellTable</a>
<a href=https://www.codetab.org/tutorial/gwt/content/gwt-autosuggest/ class="toc-page dropdown-item text-wrap text-muted">SuggestBox</a>
<a href=https://www.codetab.org/tutorial/gwt/content/titlepanel/ class="toc-page dropdown-item text-wrap text-muted">TitlePanel</a>
<a href=https://www.codetab.org/tutorial/gwt/content/gwt-uifactory/ class="toc-page dropdown-item text-wrap text-muted">UiFactory</a>
<a href=https://www.codetab.org/tutorial/gwt/content/factpanel/ class="toc-page dropdown-item text-wrap text-muted">FactPanel</a>
<a href=https://www.codetab.org/tutorial/gwt/content/gwt-disclosepanel/ class="toc-page dropdown-item text-wrap text-muted">DisclosurePanel</a>
<a href=https://www.codetab.org/tutorial/gwt/content/toolbar/ class="toc-page dropdown-item text-wrap text-muted">Toolbar</a>
<a href=https://www.codetab.org/tutorial/gwt/content/gwt-datagrid/ class="toc-page dropdown-item text-wrap text-muted">DataGrid</a>
<a href=https://www.codetab.org/tutorial/gwt/content/gwt-chart/ class="toc-page dropdown-item text-wrap text-muted">Google Chart</a>
<a href=https://www.codetab.org/tutorial/gwt/content/gwt-close-tabs/ class="toc-page dropdown-item text-wrap text-muted">Close Tabs</a></div></div><div class="dropdown show mt-2"><a class="no-collapse-on-click card-link toc-section text-dark" href=#tutorial-gwt-rpc id=dropdownheader data-toggle=collapse aria-haspopup=true aria-expanded=false>RPC</a><div id=tutorial-gwt-rpc class=collapse><a href=https://www.codetab.org/tutorial/gwt/rpc/gwt-remote-procedure-calls/ class="toc-page dropdown-item text-wrap text-muted">RPC</a>
<a href=https://www.codetab.org/tutorial/gwt/rpc/rest-of-rpc/ class="toc-page dropdown-item text-wrap text-muted">Rest of RPC</a></div></div><div class="dropdown show mt-2"><a class="no-collapse-on-click card-link toc-section text-dark" href=#tutorial-gwt-database id=dropdownheader data-toggle=collapse aria-haspopup=true aria-expanded=false>Database</a><div id=tutorial-gwt-database class=collapse><a href=https://www.codetab.org/tutorial/gwt/database/setup-database/ class="toc-page dropdown-item text-wrap text-muted">Database Setup</a>
<a href=https://www.codetab.org/tutorial/gwt/database/persist/ class="toc-page dropdown-item text-wrap text-muted">JDO Persistence</a>
<a href=https://www.codetab.org/tutorial/gwt/database/retrieve/ class="toc-page dropdown-item text-wrap text-muted">JDO and Hibernate</a>
<a href=https://www.codetab.org/tutorial/gwt/database/gwt-dao/ class="toc-page dropdown-item text-wrap text-muted">DAO</a></div></div><div class="dropdown show mt-2"><a class="no-collapse-on-click card-link toc-section text-dark" href=#tutorial-gwt-google-app-engine id=dropdownheader data-toggle=collapse aria-haspopup=true aria-expanded=false>Goolge App Engine</a><div id=tutorial-gwt-google-app-engine><a href=https://www.codetab.org/tutorial/gwt/google-app-engine/google-app-engine/ class="toc-page dropdown-item text-wrap text-muted">Google App Engine</a>
<a href=https://www.codetab.org/tutorial/gwt/google-app-engine/app-engine-deploy/ class="toc-page dropdown-item text-wrap text-muted">App Engine Deploy</a>
<a href=https://www.codetab.org/tutorial/gwt/google-app-engine/app-engine-manage-data/ class="toc-page dropdown-item text-wrap text-muted">GAE Data Upload</a>
<a href=https://www.codetab.org/tutorial/gwt/google-app-engine/app-engine-cache/ class="toc-page dropdown-item text-wrap text-danger">App Engine Cache</a>
<a href=https://www.codetab.org/tutorial/gwt/google-app-engine/app-engine-task-queue/ class="toc-page dropdown-item text-wrap text-muted">App Engine Task Queue</a>
<a href=https://www.codetab.org/tutorial/gwt/google-app-engine/app-engine-backends/ class="toc-page dropdown-item text-wrap text-muted">GAE Backends</a></div></div><div class="dropdown show mt-2"><a class="no-collapse-on-click card-link toc-section text-dark" href=#tutorial-gwt-openshift id=dropdownheader data-toggle=collapse aria-haspopup=true aria-expanded=false>OpenShift</a><div id=tutorial-gwt-openshift class=collapse><a href=https://www.codetab.org/tutorial/gwt/openshift/openshift/ class="toc-page dropdown-item text-wrap text-muted">OpenShift Setup</a>
<a href=https://www.codetab.org/tutorial/gwt/openshift/prepare-openshift-project/ class="toc-page dropdown-item text-wrap text-muted">Prepare Project</a>
<a href=https://www.codetab.org/tutorial/gwt/openshift/openshift-configure/ class="toc-page dropdown-item text-wrap text-muted">Configure</a>
<a href=https://www.codetab.org/tutorial/gwt/openshift/openshift-build-deploy/ class="toc-page dropdown-item text-wrap text-muted">Build and Deploy</a>
<a href=https://www.codetab.org/tutorial/gwt/openshift/openshift-development/ class="toc-page dropdown-item text-wrap text-muted">Development</a>
<a href=https://www.codetab.org/tutorial/gwt/openshift/openshift-online-v3-deployment/ class="toc-page dropdown-item text-wrap text-muted">OpenShift Online V3 Deployment</a></div></div><div class="dropdown show mt-2"><a class="no-collapse-on-click card-link toc-section text-dark" href=#tutorial-gwt-build id=dropdownheader data-toggle=collapse aria-haspopup=true aria-expanded=false>Apache Ivy</a><div id=tutorial-gwt-build class=collapse><a href=https://www.codetab.org/tutorial/gwt/build/apache-ivy/ class="toc-page dropdown-item text-wrap text-muted">Apache Ivy</a></div></div></div></div></nav></nav></div></aside><div id=contentbar class=col-md-7><div id=share class="row justify-content-end"><div title=twitter><a href="https://twitter.com/intent/tweet?url=https://www.codetab.org/tutorial/gwt/google-app-engine/app-engine-cache/&text=GAE%20Cache%20-%20GWT%20Tutorial%20-%20CodeTab" target=_blank rel=noopener><i class="icon-twitter-squared text-secondary"></i></a></div><div title=facebook><a href="https://www.facebook.com/sharer.php?u=https://www.codetab.org/tutorial/gwt/google-app-engine/app-engine-cache/&t=GAE%20Cache%20-%20GWT%20Tutorial%20-%20CodeTab" target=_blank rel=noopener><i class="icon-facebook-squared text-secondary"></i></a></div><div title=linkedin><a href="https://www.linkedin.com/shareArticle?url=https://www.codetab.org/tutorial/gwt/google-app-engine/app-engine-cache/&title=GAE%20Cache%20-%20GWT%20Tutorial%20-%20CodeTab" target=_blank rel=noopener><i class="icon-linkedin-squared text-secondary"></i></a></div><div title=email><a href="mailto:?subject=GAE%20Cache%20-%20GWT%20Tutorial%20-%20CodeTab&body=https://www.codetab.org/tutorial/gwt/google-app-engine/app-engine-cache/" target=_blank rel=noopener><i class="icon-mail-squared text-secondary"></i></a></div><div title=whatsapp><a href="https://web.whatsapp.com/send?text=GAE%20Cache%20-%20GWT%20Tutorial%20-%20CodeTab%20https://www.codetab.org/tutorial/gwt/google-app-engine/app-engine-cache/" target=_blank rel=noopener><i class="icon-whatsapp text-secondary"></i></a></div><div title=reddit><a href="https://reddit.com/submit?url=https://www.codetab.org/tutorial/gwt/google-app-engine/app-engine-cache/&title=GAE%20Cache%20-%20GWT%20Tutorial%20-%20CodeTab" target=_blank rel=noopener><i class="icon-reddit-alien text-secondary"></i></a></div><i class="icon-blank ctab-transparent"></i></div><div class=row><main id=content class="col-md-11 post-basic"><h2 id=112cache>11.2. Cache</h2><p>The next task is to cache the symbols in App Engine MemCache. By moving
the symbols from List&lt;Symbol> in <code>UploadService</code> servlet to MemCache,
they become accessible to App Engine services like Queue, Tasks etc.</p><h5 id=cachepanel>CachePanel</h5><p>This widget has two Buttons - Cache Symbols and Clear cache, with
obvious functionality.</p><figure class=text-center><img class="lazy img-fluid" data-src=/tutorial/gwt/media/cachepanel.png alt=CachePanel></figure><h6 id=figure113cachepanel>Figure 11.3. CachePanel</h6><p>Its design is similar to the <code>UploadPanel</code> described in the previous
section, and it uses <code>FormPanel</code> to submit data to the server and
invokes <code>UploadService</code> servlet, through regular HTML form submission
rather than GWT RPC.</p><p><code>CachePanel</code> is added to <code>DataStore</code> content page, in its UI declaration
file.</p><p><code>in.fins.client.content/DataStore.ui.xml</code></p><div class=highlight><pre class=chroma><code class=language-XML data-lang=XML>....
         <span class=nt>&lt;g:VerticalPanel</span> <span class=na>spacing=</span><span class=s>&#34;40&#34;</span><span class=nt>&gt;</span>
               <span class=nt>&lt;f:UploadPanel</span> <span class=nt>/&gt;</span>
               <span class=nt>&lt;f:CachePanel</span> <span class=nt>/&gt;</span>
          <span class=nt>&lt;/g:VerticalPanel&gt;</span>
      <span class=nt>&lt;/g:layer&gt;</span>
   <span class=nt>&lt;/g:LayoutPanel&gt;</span>
<span class=nt>&lt;/ui:UiBinder&gt;</span>
</code></pre></div><h5 id=cache>Cache</h5><p>App Engine provides distributed in-memory data cache service known as
MemCache, and high performance web applications ofter use them to reduce
datastore access. App Engine Cache API comes in two flavors - JCache and
Low Level API. JCache provides a map-like interface to cache where data
is stored and retrieved using keys where value is any Serializable type
or class. Low Level API is richer and provides MemcacheService and
AsyncMemcacheService. By default, data is retained by cache as long as
possible and evicted only when it is low on memory. Maximum size of each
cached object is l MB.</p><p>We use cache to hold Symbols and for this, JCache API is sufficient.
But, Fins should be able to use the cache even when it runs on a regular
app server like JBoss. JCache is based on, yet to be official, JSR 107
proposal and App Engine uses one of its implementation,
net.sf.jsr107cache. We encountered some issues in using this interface
in non App Engine environment, so decided to move the cache operations
behind our own interface, which enable us to switch cache while moving
out of App Engine. For non App Engine setup, we have the option to use
industry standard cache modules like Ehcache etc., but for our limited
use of cache, it is a overkill and hence, we are going to use a simple
custom cache.</p><p>Following figure shows the cache interaction by <code>UploadService</code>.</p><figure class=text-center><img class="lazy img-fluid" data-src=/tutorial/gwt/media/cache.png alt="Cache interface"></figure><h6 id=figure114cache-interface>Figure 11.4. Cache interface</h6><p>Interactions between <code>UploadService</code> and cache happens through interface
<code>ICache</code>, which defines the methods to interact with the cache. Both; <code>GaeCache</code> used in App Engine, and <code>SimpleCache</code> used in regular app
server, implements <code>ICache</code>.</p><p><code>in.fins.server.cache/ICache.java</code></p><div class=highlight><pre class=chroma><code class=language-Java data-lang=Java><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>ICache</span> <span class=o>{</span>

        <span class=kd>public</span> <span class=kt>void</span> <span class=nf>createCache</span><span class=o>()</span> <span class=kd>throws</span> <span class=n>Exception</span><span class=o>;</span>

        <span class=kd>public</span> <span class=kt>void</span> <span class=nf>put</span><span class=o>(</span><span class=n>String</span> <span class=n>key</span><span class=o>,</span> <span class=n>Object</span> <span class=n>value</span><span class=o>);</span>

        <span class=kd>public</span> <span class=n>Object</span> <span class=nf>get</span><span class=o>(</span><span class=n>String</span> <span class=n>key</span><span class=o>);</span>

        <span class=kd>public</span> <span class=kt>void</span> <span class=nf>clear</span><span class=o>();</span>
<span class=o>}</span>
</code></pre></div><p>ICache provide access to cache through a map-like interface, where
method <code>put()</code> stores key and value in the cache, and method <code>get()</code>
retrieves the value object for a key.</p><div>&nbsp;</div><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-1281079745125126 data-ad-slot=6135368983></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script><div>&nbsp;</div><p><code>GaeCache</code> obtains reference to MemCache through, <code>CacheManager</code> and
<code>CacheFactory</code>.</p><p><code>in.fins.server.cache/GaeCache.java</code></p><div class=highlight><pre class=chroma><code class=language-Java data-lang=Java><span class=kd>public</span> <span class=kd>class</span> <span class=nc>GaeCache</span> <span class=kd>implements</span> <span class=n>ICache</span> <span class=o>{</span>

    <span class=kd>private</span> <span class=n>Cache</span> <span class=n>cache</span><span class=o>;</span>

    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>createCache</span><span class=o>()</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
        <span class=k>try</span> <span class=o>{</span>
          <span class=k>if</span> <span class=o>(</span><span class=n>cache</span> <span class=o>==</span> <span class=kc>null</span><span class=o>)</span> <span class=o>{</span>
              <span class=n>CacheFactory</span> <span class=n>cacheFactory</span> <span class=o>=</span> 
                    <span class=n>CacheManager</span><span class=o>.</span><span class=na>getInstance</span><span class=o>()</span> <span class=o>.</span><span class=na>getCacheFactory</span><span class=o>();</span>
              <span class=n>cache</span> <span class=o>=</span> <span class=n>cacheFactory</span><span class=o>.</span><span class=na>createCache</span><span class=o>(</span><span class=n>Collections</span><span class=o>.</span><span class=na>emptyMap</span><span class=o>());</span>
          <span class=o>}</span>
        <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>CacheException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
              <span class=n>log</span><span class=o>.</span><span class=na>warning</span><span class=o>(</span><span class=n>e</span><span class=o>.</span><span class=na>getMessage</span><span class=o>());</span>
              <span class=k>throw</span> <span class=n>e</span><span class=o>;</span>
        <span class=o>}</span>
    <span class=o>}</span>
</code></pre></div><p><code>SimpleCache</code>, which used in regular app server setup, uses a singleton
class <code>Cache</code> which internally uses a HashMap&lt;String,Object> to hold
cache data. Cache is is a non public class of SimpleCache.</p><p><code>in.fins.server.cache/GaeCache.java</code></p><div class=highlight><pre class=chroma><code class=language-Java data-lang=Java><span class=kd>public</span> <span class=kd>class</span> <span class=nc>SimpleCache</span> <span class=kd>implements</span> <span class=n>ICache</span> <span class=o>{</span>

        <span class=kd>private</span> <span class=n>Cache</span> <span class=n>cache</span><span class=o>;</span>

        <span class=nd>@Override</span>
        <span class=kd>public</span> <span class=kt>void</span> <span class=nf>createCache</span><span class=o>()</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
                <span class=n>cache</span> <span class=o>=</span> <span class=n>Cache</span><span class=o>.</span><span class=na>INSTANCE</span><span class=o>;</span>
        <span class=o>}</span>

        <span class=nd>@Override</span>
        <span class=kd>public</span> <span class=kt>void</span> <span class=nf>put</span><span class=o>(</span><span class=n>String</span> <span class=n>key</span><span class=o>,</span> <span class=n>Object</span> <span class=n>value</span><span class=o>)</span> <span class=o>{</span>
                <span class=n>cache</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=n>key</span><span class=o>,</span> <span class=n>value</span><span class=o>);</span>
        <span class=o>}</span>
        <span class=o>....</span>
<span class=o>}</span>

<span class=c1>// Singleton Cache
</span><span class=c1></span>
<span class=kd>class</span> <span class=nc>Cache</span> <span class=o>{</span>

        <span class=kd>public</span> <span class=kd>static</span> <span class=kd>final</span> <span class=n>Cache</span> <span class=n>INSTANCE</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Cache</span><span class=o>();</span>

        <span class=kd>private</span> <span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=o>,</span> <span class=n>Object</span><span class=o>&gt;</span> <span class=n>cache</span><span class=o>;</span>

        <span class=kd>private</span> <span class=nf>Cache</span><span class=o>()</span> <span class=o>{</span>
                <span class=n>cache</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashMap</span><span class=o>&lt;</span><span class=n>String</span><span class=o>,</span> <span class=n>Object</span><span class=o>&gt;();</span>
        <span class=o>}</span>

        <span class=kd>public</span> <span class=kt>void</span> <span class=nf>put</span><span class=o>(</span><span class=n>String</span> <span class=n>key</span><span class=o>,</span> <span class=n>Object</span> <span class=n>value</span><span class=o>)</span> <span class=o>{</span>
                <span class=n>cache</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=n>key</span><span class=o>,</span> <span class=n>value</span><span class=o>);</span>
        <span class=o>}</span>
        
        <span class=o>....</span>
<span class=o>}</span>
</code></pre></div><p><code>UploadService</code> uses <code>cacheSymbols()</code> and <code>clearSymbols()</code> methods to
handle user requests on form submission. These methods create
appropriate cache based on the platform on which app is running.</p><p><code>in.fins.server.cache/GaeCache.java</code></p><div class=highlight><pre class=chroma><code class=language-Java data-lang=Java><span class=o>....</span>
 <span class=kd>private</span> <span class=n>String</span> <span class=nf>cacheSymbols</span><span class=o>()</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
 
        <span class=n>String</span> <span class=n>serverName</span> <span class=o>=</span> <span class=n>getServerName</span><span class=o>();</span>
        <span class=n>ICache</span> <span class=n>cache</span> <span class=o>=</span> <span class=kc>null</span><span class=o>;</span> 
        <span class=k>if</span> <span class=o>(</span><span class=n>serverName</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=s>&#34;GAE&#34;</span><span class=o>))</span> <span class=o>{</span>
                <span class=n>cache</span> <span class=o>=</span> <span class=n>Utils</span><span class=o>.</span><span class=na>createInstance</span><span class=o>(</span><span class=n>ICache</span><span class=o>.</span><span class=na>class</span><span class=o>,</span>
                                <span class=s>&#34;in.fins.server.cache.GaeCache&#34;</span><span class=o>);</span>
        <span class=o>}</span> <span class=k>else</span> <span class=o>{</span>
                <span class=n>cache</span> <span class=o>=</span> <span class=n>Utils</span><span class=o>.</span><span class=na>createInstance</span><span class=o>(</span><span class=n>ICache</span><span class=o>.</span><span class=na>class</span><span class=o>,</span>
                                <span class=s>&#34;in.fins.server.cache.SimpleCache&#34;</span><span class=o>);</span>
        <span class=o>}</span>
        <span class=n>cache</span><span class=o>.</span><span class=na>createCache</span><span class=o>();</span>
                  <span class=o>....</span>
  <span class=o>}</span>
 
  <span class=kd>private</span> <span class=n>String</span> <span class=nf>getServerName</span><span class=o>()</span> <span class=o>{</span>
        <span class=n>String</span> <span class=n>serverName</span> <span class=o>=</span> <span class=n>getServletContext</span><span class=o>().</span><span class=na>getServerInfo</span><span class=o>();</span>
        <span class=k>if</span> <span class=o>(</span><span class=n>serverName</span><span class=o>.</span><span class=na>startsWith</span><span class=o>(</span><span class=s>&#34;Google App Engine&#34;</span><span class=o>))</span> <span class=o>{</span>
                <span class=k>return</span> <span class=s>&#34;GAE&#34;</span><span class=o>;</span>
        <span class=o>}</span> <span class=k>else</span> <span class=o>{</span>
                <span class=k>return</span> <span class=n>serverName</span><span class=o>;</span>
        <span class=o>}</span>
  <span class=o>}</span>
</code></pre></div><p>Depending on the platform name returned by <code>getServerName() </code>method,
<code>cacheSymbols()</code> obtains an instance of either <code>GaeCache</code> or
<code>SimpleCache</code>, through helper method <code>Utils.createInstance()</code> . The util
method creates an instance based on the class name string, and this
ensures that UploadService compiles, even when App Engine related
libraries are not available in project class path, which is normally the
case when we use the Fins in regular app server setup.</p><p>Once cache is obtained, <code>cacheSymbols()</code> method iterates through
List&lt;Symbol> and cache the symbol with symbol name as key. While doing
so, it also creates and cache a list of symbol names, which is later
used as key set.</p><p><code>in.fins.server.cache/GaeCache.java</code></p><div class=highlight><pre class=chroma><code class=language-Java data-lang=Java>        <span class=n>List</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>symbolNames</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;();</span>
        <span class=k>for</span> <span class=o>(</span><span class=n>Symbol</span> <span class=n>symbol</span> <span class=o>:</span> <span class=n>symbols</span><span class=o>)</span> <span class=o>{</span>
                <span class=n>cache</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=n>symbol</span><span class=o>.</span><span class=na>getName</span><span class=o>(),</span> <span class=n>symbol</span><span class=o>);</span>
                <span class=n>symbolNames</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>symbol</span><span class=o>.</span><span class=na>getName</span><span class=o>());</span>
        <span class=o>}</span>
        <span class=n>cache</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=s>&#34;symbolNames&#34;</span><span class=o>,</span> <span class=n>symbolNames</span><span class=o>);</span>
        <span class=kt>int</span> <span class=n>cacheCount</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>

        <span class=c1>// check cache consistency
</span><span class=c1></span>        <span class=k>for</span> <span class=o>(</span><span class=n>String</span> <span class=n>name</span> <span class=o>:</span> <span class=n>symbolNames</span><span class=o>)</span> <span class=o>{</span>
                <span class=n>Object</span> <span class=n>o</span> <span class=o>=</span> <span class=n>cache</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>name</span><span class=o>);</span>
                <span class=k>if</span> <span class=o>(</span><span class=n>o</span> <span class=k>instanceof</span> <span class=n>Symbol</span><span class=o>)</span> <span class=o>{</span>
                        <span class=n>cacheCount</span><span class=o>++;</span>
                <span class=o>}</span>
        <span class=o>}</span>
        <span class=k>if</span> <span class=o>(</span><span class=n>cacheCount</span> <span class=o>!=</span> <span class=n>symbolNames</span><span class=o>.</span><span class=na>size</span><span class=o>())</span> <span class=o>{</span>
                <span class=n>status</span> <span class=o>+=</span> 
                  <span class=s>&#34;Cache inconsistency. Try this option again to rectify.&#34;</span><span class=o>;</span>
        <span class=o>}</span>
        <span class=k>return</span> <span class=n>status</span><span class=o>;</span>
</code></pre></div><div>&nbsp;</div><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-1281079745125126 data-ad-slot=6135368983></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script><div>&nbsp;</div><p>For some unknown reasons, occasionally, we could not find the some of
the symbols in cache even though they were handed over to the cache. In
such cases, inconsistency is reported back to the user and invoking the
option again usually rectify the inconsistency.</p><p>Once symbols are in cache, we can go ahead with the task of persisting
them to App Engine&rsquo;s datastore.</p></main></div></div><aside id=sidebar-right class=col-md-2><div class="row my-5 justify-content-center border"><div>&nbsp;</div><ins class=adsbygoogle style=display:inline-block;width:160px;height:600px data-ad-client=ca-pub-1281079745125126 data-ad-slot=8963022093></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script><div>&nbsp;</div></div></aside></div></div><footer class="container-fluid mt-5"><div class=row><div class="col ml-auto"><div class="row mb-1 ml-2"><a class=text-muted href=/privacy-policy>Privacy</a></div><div class="row text-muted mb-2 ml-2"><span>&copy; 2019 &#183;Powered by <a href=https://gohugo.io target=_blank rel=noopener>Hugo</a></span></div></div><div class="col mr-auto"><span class=float-right><a href=# id=back_to_top><i class="icon-up-open h1 text-secondary"></i></a></span></div></div></footer><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script src=/js/vendor.min.8489448e4e75ceb388a38abde3871de9485502974c5feddcf04a3d413dc6e103.js></script></body></html>