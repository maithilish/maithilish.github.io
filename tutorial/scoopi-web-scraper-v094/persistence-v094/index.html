<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=description content="With persistence, Scoopi Web Scraper offers following benefits - reduce downloads, recover from the aborted run, avoid expensive parse operation"><meta name=author content="Maithilish"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-42139846-3"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-42139846-3');</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://google.com/article"},"articleSection":"tutorial","name":"Persistence - Scoopi Web Scraper - CodeTab","headline":"Persistence - Scoopi Web Scraper - CodeTab","url":"https://www.codetab.org/tutorial/scoopi-web-scraper-v094/persistence-v094/","description":"With persistence, Scoopi Web Scraper offers following benefits - reduce downloads, recover from the aborted run, avoid expensive parse operation","inLanguage":"en","image":"https://www.codetab.org/logo.jpg","author":"Maithilish","creator":"Maithilish","publisher":{"@type":"Organization","name":"Maithilish","url":"https://www.codetab.org/","logo":{"@type":"ImageObject","url":"https://www.codetab.org/logo.png","width":"200","height":"200"}},"copyrightHolder":"Maithilish","copyrightYear":"2019","datePublished":"2019-01-12T04:11:00+0530","dateModified":"2019-01-12T04:11:00+0530","wordCount":"537","keywords":["persistence","Blog"]}</script><link rel=icon href=/favicon.ico><link rel=stylesheet href=/css/vendor.min.e7fd2d89f73c680873529a110a9007503a1bda864a3a3a6c53c4eb02a54c35eb.css integrity="sha256-5/0tifc8aAhzUpoRCpAHUDob2oZKOjpsU8TrAqVMNes="><title>Persistence - Scoopi Web Scraper - CodeTab</title></head><body id=top><header><nav id=navbar-main class="navbar fixed-top navbar-light navbar-expand-lg bg-white border-bottom shadow-sm"><div class=container-fluid><a class=navbar-brand href=/>Codetab</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbar aria-controls=navbar aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbar><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=/#tutorials><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/#projects><span>Projects</span></a></li><li class=nav-item><a class=nav-link href=/post><span>Posts</span></a></li><li class=nav-item><a class=nav-link href=/#about><span>About</span></a></li></ul></div></div></nav></header><div class=container-fluid><div class=row>&nbsp;</div><div class=row><aside id=sidebar class=col-md-3><div class=row><nav id=navbar-side class="bg-light text-secondary"><h4 class="text-muted bg-white pl-2">Scoopi Web Scraper</h4><nav class="navbar navbar-light bg-white navbar-expand-md"><button class="navbar-toggler ml-auto" type=button data-toggle=collapse data-target=#bookmenu aria-controls=bookmenu aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=bookmenu><div><div id="Scoopi Web Scraper V094"><div><a href=https://www.codetab.org/tutorial/scoopi-web-scraper-v094/introduction/ class="toc-page text-wrap text-muted">Introduction</a></div><div><a href=https://www.codetab.org/tutorial/scoopi-web-scraper-v094/installation-quick-start-v094/ class="toc-page text-wrap text-muted">Installation and Quick Start</a></div><div><a href=https://www.codetab.org/tutorial/scoopi-web-scraper-v094/definition-file-v094/ class="toc-page text-wrap text-muted">Definition File</a></div><div><a href=https://www.codetab.org/tutorial/scoopi-web-scraper-v094/datadef-v094/ class="toc-page text-wrap text-muted">DataDef</a></div><div><a href=https://www.codetab.org/tutorial/scoopi-web-scraper-v094/selector-v094/ class="toc-page text-wrap text-muted">Selector</a></div><div><a href=https://www.codetab.org/tutorial/scoopi-web-scraper-v094/members-v094/ class="toc-page text-wrap text-muted">Members</a></div><div><a href=https://www.codetab.org/tutorial/scoopi-web-scraper-v094/index-indexrange-breakafter-v094/ class="toc-page text-wrap text-muted">Index, IndexRange and BreakAfter</a></div><div><a href=https://www.codetab.org/tutorial/scoopi-web-scraper-v094/filters-v094/ class="toc-page text-wrap text-muted">Filters</a></div><div><a href=https://www.codetab.org/tutorial/scoopi-web-scraper-v094/multiple-tasks-v094/ class="toc-page text-wrap text-muted">Multiple Tasks</a></div><div><a href=https://www.codetab.org/tutorial/scoopi-web-scraper-v094/steps-and-plugins-v094/ class="toc-page text-wrap text-muted">Steps and Plugins</a></div><div><a href=https://www.codetab.org/tutorial/scoopi-web-scraper-v094/converters-v094/ class="toc-page text-wrap text-muted">Converters</a></div><div><a href=https://www.codetab.org/tutorial/scoopi-web-scraper-v094/create-locators-links-v094/ class="toc-page text-wrap text-muted">Create Locators from Links</a></div><div><a href=https://www.codetab.org/tutorial/scoopi-web-scraper-v094/persistence-v094/ class="toc-page text-wrap text-danger">Persistence</a></div><div><a href=https://www.codetab.org/tutorial/scoopi-web-scraper-v094/appender-and-encoder-v094/ class="toc-page text-wrap text-muted">Appender and Encoder</a></div><div><a href=https://www.codetab.org/tutorial/scoopi-web-scraper-v094/split-definitions-v094/ class="toc-page text-wrap text-muted">Split Definitions</a></div><div><a href=https://www.codetab.org/tutorial/scoopi-web-scraper-v094/logs-v094/ class="toc-page text-wrap text-muted">Logs</a></div><div><a href=https://www.codetab.org/tutorial/scoopi-web-scraper-v094/dashboard-v094/ class="toc-page text-wrap text-muted">Dashboard</a></div><div><a href=https://www.codetab.org/tutorial/scoopi-web-scraper-v094/db-setup-v094/ class="toc-page text-wrap text-muted">DB Setup</a></div></div></div></div></nav></nav></div></aside><div id=contentbar class=col-md-7><div id=share class="row justify-content-end"><div title=twitter><a href="https://twitter.com/intent/tweet?url=https://www.codetab.org/tutorial/scoopi-web-scraper-v094/persistence-v094/&text=Persistence%20-%20Scoopi%20Web%20Scraper%20-%20CodeTab" target=_blank rel=noopener><i class="icon-twitter-squared text-secondary"></i></a></div><div title=facebook><a href="https://www.facebook.com/sharer.php?u=https://www.codetab.org/tutorial/scoopi-web-scraper-v094/persistence-v094/&t=Persistence%20-%20Scoopi%20Web%20Scraper%20-%20CodeTab" target=_blank rel=noopener><i class="icon-facebook-squared text-secondary"></i></a></div><div title=linkedin><a href="https://www.linkedin.com/shareArticle?url=https://www.codetab.org/tutorial/scoopi-web-scraper-v094/persistence-v094/&title=Persistence%20-%20Scoopi%20Web%20Scraper%20-%20CodeTab" target=_blank rel=noopener><i class="icon-linkedin-squared text-secondary"></i></a></div><div title=email><a href="mailto:?subject=Persistence%20-%20Scoopi%20Web%20Scraper%20-%20CodeTab&body=https://www.codetab.org/tutorial/scoopi-web-scraper-v094/persistence-v094/" target=_blank rel=noopener><i class="icon-mail-squared text-secondary"></i></a></div><div title=whatsapp><a href="https://web.whatsapp.com/send?text=Persistence%20-%20Scoopi%20Web%20Scraper%20-%20CodeTab%20https://www.codetab.org/tutorial/scoopi-web-scraper-v094/persistence-v094/" target=_blank rel=noopener><i class="icon-whatsapp text-secondary"></i></a></div><div title=reddit><a href="https://reddit.com/submit?url=https://www.codetab.org/tutorial/scoopi-web-scraper-v094/persistence-v094/&title=Persistence%20-%20Scoopi%20Web%20Scraper%20-%20CodeTab" target=_blank rel=noopener><i class="icon-reddit-alien text-secondary"></i></a></div><div title=weibo><a href="https://service.weibo.com/share/share.php?url=https://www.codetab.org/tutorial/scoopi-web-scraper-v094/persistence-v094/&title=Persistence%20-%20Scoopi%20Web%20Scraper%20-%20CodeTab" target=_blank rel=noopener><i class="icon-weibo text-secondary"></i></a></div><i class="icon-blank ctab-transparent"></i></div><div class=row><main id=content class="col-md-11 post-basic"><h1 id=persistence>Persistence</h1><p>With persistence, Scoopi offers following benefits.</p><ul><li>reduce network usage as it can reuse the downloaded pages</li><li>recover from the aborted run without redoing the tasks already
completed</li><li>avoid expensive parse operation as it can reuse the persisted data</li><li>set expiry date for each page</li></ul><h2 id=setup-database>Setup Database</h2><p>If you running Scoopi from docker image then no database setup is
required as docker image contains pre-configured MariaDB container.
Please refer <a href=/tutorial/scoopi-web-scraper-v094/installation-quick-start-v094/#scoopi-with-mariadb>Scoopi with MariaDB</a> to run Scoopi with MariaDB using docker-compose.</p><p>In case you are using release package from GitHub to run Scoopi, then
you have to set up MariaDB or HSQLDB database manually. See <a href=/tutorial/scoopi-web-scraper-v094/db-setup-v094/>HSQLDB
Setup</a> to setup and configure Hsql
database.</p><h2 id=enable-persistence-in-scoopi>Enable Persistence in Scoopi</h2><p>By default persistence is disabled in Scoopi through configuration
setting <em>scoopi.useDatastore=false</em> in <code>conf/scoopi.properties</code> file. To
enable persistence, either set the property <em>scoopi.useDatastore=true</em>
or hash it out.</p><p>Now run <a href=https://github.com/maithilish/scoopi/blob/master/src/main/resources/defs/examples/jsoup/ex-10/job.yml target=_blank>Example 10</a> and scoopi database should have locator, datadef, data and document tables with data.</p><h2 id=live>Live</h2><p>When we first run Example-10 with persistence enabled, <em>document table</em>
which holds compressed contents of the pages - acme-quote-links.html,
acme-bs.html and acme-pl.html will end up with three rows and <em>data
table</em> which holds the parsed data will have five rows - finLinks,
price, snapshot, bs and pl.</p><p>If we run Scoopi again and query the tables, the document table will
have 6 rows and data table will end up with 10 rows. For each run,
Scoopi fetches fresh pages and parse it to create data even though
persistence is enabled. This is because, by default, <em>live</em> setting
which controls the expiry of page is set to zero days (P0D). So, in each
run, Scoopi sees page as expired and fetches new one. Use live property
in tasks group to alter this default behavior.</p><p>Suppose, we want to fetch new quote page once in a week. The
<a href=https://github.com/maithilish/scoopi/blob/master/src/main/resources/defs/examples/jsoup/ex-11/job.yml target=_blank>Example 11</a>
sets live property to P1W for quoteGroup as shown below</p><pre><code class=language-raw data-lang=raw>
taskGroups:

  quoteGroup:

    priceTask:
      dataDef: price

    snapshotTask:
      dataDef: snapshot

    live: P1W
</code></pre><p>The P0D, P1W are
<a href=https://en.wikipedia.org/wiki/ISO_8601#Durations target=_blank>ISO_8601</a> based
representation of duration.</p><p>Now only for first run fresh pages are fetched and persisted and for
subsequent runs the persisted page and data are reused till pages are
expired. This speeds up the run by many fold.</p><h2 id=persist-control>Persist Control</h2><p>We can further control persistence of locator or data using persist
property.</p><p>In <code>conf/scoopi.properties</code> we can set following properties</p><pre><code>scoopi.useDatastore=true|false

scoopi.persist.locator=true|false
scoopi.persist.data=true|false
</code></pre><p>If scoopi.useDatastore is false then there is no need to start database
as nothing is stored. If scoopi.useDatastore is true, then</p><ul><li>if scoopi.persist.locator is false then no locator and its documents
are stored</li><li>if scoopi.persist.data is false then no data is stored</li></ul><p>If scoopi.persist.data is true, then in addition, we can control whether
to persist data of each task using <em>persist/data</em> property in task
definition. The
<a href=https://github.com/maithilish/scoopi/blob/master/src/main/resources/defs/examples/jsoup/ex-12/job.yml target=_blank>Example 12</a></p><pre><code class=language-raw data-lang=raw>
taskGroups:

  quoteGroup:

    priceTask:
      dataDef: price
      persist:
        data: true

    snapshotTask:
      dataDef: snapshot
      persist:
        data: false
</code></pre><p>The data parsed by priceTask are stored but not the snapshotTask as
persist/data is false for that task.</p><h2 id=use-scoopi-with-other-databases>Use Scoopi with other Databases</h2><p>Scoopi uses <a href=https://db.apache.org/jdo/ target=_blank>JDO</a> and <a href=http://www.datanucleus.org/ target=_blank>DataNucleus
AccessPlatform</a> which works with variety of
databases. Scoopi is tested with MySQL, MariaDB and MongoDB and
configuration for each of them is in <code>conf/jdoconfig.properties</code> file.</p><p>In the next chapter we look at appenders.</p></main></div></div><aside id=sidebar-right class=col-md-2><div class="row my-5 justify-content-center border"><div>&nbsp;</div><ins class=adsbygoogle style=display:inline-block;width:160px;height:600px data-ad-client=ca-pub-1281079745125126 data-ad-slot=8963022093></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script><div>&nbsp;</div></div></aside></div></div><footer class="container-fluid mt-5"><div class=row><div class="col ml-auto"><div class="row mb-1 ml-2"><a class=text-muted href=/privacy-policy>Privacy</a></div><div class="row text-muted mb-2 ml-2"><span>&copy; 2019 &#183;Powered by <a href=https://gohugo.io target=_blank rel=noopener>Hugo</a></span></div></div><div class="col mr-auto"><span class=float-right><a href=# id=back_to_top><i class="icon-up-open h1 text-secondary"></i></a></span></div></div></footer><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script src=/js/vendor.min.8489448e4e75ceb388a38abde3871de9485502974c5feddcf04a3d413dc6e103.js></script></body></html>