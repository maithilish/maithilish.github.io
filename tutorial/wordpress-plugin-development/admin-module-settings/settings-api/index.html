<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=description content="In this tutorial, we explain how to add sections and fields to the menu page with WordPress Settings API and partially automate options management."><meta name=author content="Maithilish"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-42139846-3"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-42139846-3")</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://google.com/article"},"articleSection":"tutorial","name":"Settings API - WordPress Plugin Development - CodeTab","headline":"Settings API - WordPress Plugin Development - CodeTab","url":"https://www.codetab.org/tutorial/wordpress-plugin-development/admin-module-settings/settings-api/","description":"In this tutorial, we explain how to add sections and fields to the menu page with WordPress Settings API and partially automate options management.","inLanguage":"en","image":"https://www.codetab.org/logo.jpg","author":"Maithilish","creator":"Maithilish","publisher":{"@type":"Organization","name":"Maithilish","url":"https://www.codetab.org/","logo":{"@type":"ImageObject","url":"https://www.codetab.org/logo.png","width":"200","height":"200"}},"copyrightHolder":"Maithilish","copyrightYear":"2019","datePublished":"2019-01-11T09:27:00+0530","dateModified":"2019-01-11T09:27:00+0530","wordCount":"1099","keywords":["wordpress settings api","Blog"]}</script><link rel=icon href=/favicon.ico><link rel=stylesheet href=/css/vendor.min.36dba173dca94f4b9fca7c6a1c3d15560f7a96c6ab0c0042dcd000f8469a9dc1.css integrity="sha256-Ntuhc9ypT0ufynxqHD0VVg96lsarDABC3NAA+EaancE="><title>Settings API - WordPress Plugin Development - CodeTab</title><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1281079745125126" crossorigin=anonymous></script></head><body id=top><header><nav id=navbar-main class="navbar fixed-top navbar-light navbar-expand-lg bg-white border-bottom shadow-sm"><div class=container-fluid><a class=navbar-brand href=/>Codetab</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbar aria-controls=navbar aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbar><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=/#tutorials><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/#projects><span>Projects</span></a></li><li class=nav-item><a class=nav-link href=/post><span>Posts</span></a></li><li class=nav-item><a class=nav-link href=/#about><span>About</span></a></li></ul></div></div></nav></header><div class=container-fluid><div class=row>&nbsp;</div><div class=row><aside id=sidebar class=col-md-3><div class=row><nav id=navbar-side class="bg-light text-secondary"><h4 class="text-muted bg-white pl-2">WP Plugin Development</h4><nav class="navbar navbar-light bg-white navbar-expand-md"><button class="navbar-toggler ml-auto" type=button data-toggle=collapse data-target=#bookmenu aria-controls=bookmenu aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=bookmenu><div><div id="WordPress Plugin Development - CodeTab"><div><a href=https://www.codetab.org/tutorial/wordpress-plugin-development/introduction/ class="toc-page text-wrap text-muted">Introduction</a></div><div><a href=https://www.codetab.org/tutorial/wordpress-plugin-development/install-locally/ class="toc-page text-wrap text-muted">Install WP on Docker</a></div><div><a href=https://www.codetab.org/tutorial/wordpress-plugin-development/simple-plugin/ class="toc-page text-wrap text-muted">Simple Plugin</a></div><div><a href=https://www.codetab.org/tutorial/wordpress-plugin-development/shortcode/ class="toc-page text-wrap text-muted">Shortcode</a></div><div><a href=https://www.codetab.org/tutorial/wordpress-plugin-development/plugin-structure/ class="toc-page text-wrap text-muted">Plugin Structure</a></div><div><a href=https://www.codetab.org/tutorial/wordpress-plugin-development/plugin-main-file/ class="toc-page text-wrap text-muted">Main File</a></div><div><a href=https://www.codetab.org/tutorial/wordpress-plugin-development/hooks-actions-filters/ class="toc-page text-wrap text-muted">Hooks, Actions, Filters</a></div></div><div class="dropdown show mt-2"><a class="no-collapse-on-click card-link toc-section text-dark" href=#tutorial-wordpress-plugin-development-admin-module-settings id=dropdownheader data-toggle=collapse aria-haspopup=true aria-expanded=false>Admin - Settings</a><div id=tutorial-wordpress-plugin-development-admin-module-settings><a href=https://www.codetab.org/tutorial/wordpress-plugin-development/admin-module-settings/add-menu/ class="toc-page dropdown-item text-wrap text-muted">Add Menu</a>
<a href=https://www.codetab.org/tutorial/wordpress-plugin-development/admin-module-settings/settings-api/ class="toc-page dropdown-item text-wrap text-danger">Settings API</a>
<a href=https://www.codetab.org/tutorial/wordpress-plugin-development/admin-module-settings/options-page/ class="toc-page dropdown-item text-wrap text-muted">Options Page</a></div></div><div class="dropdown show mt-2"><a class="no-collapse-on-click card-link toc-section text-dark" href=#tutorial-wordpress-plugin-development-admin-module-custom-posts id=dropdownheader data-toggle=collapse aria-haspopup=true aria-expanded=false>Admin - Posts</a><div id=tutorial-wordpress-plugin-development-admin-module-custom-posts class=collapse><a href=https://www.codetab.org/tutorial/wordpress-plugin-development/admin-module-custom-posts/post-type/ class="toc-page dropdown-item text-wrap text-muted">Custom Post Type</a>
<a href=https://www.codetab.org/tutorial/wordpress-plugin-development/admin-module-custom-posts/meta-box/ class="toc-page dropdown-item text-wrap text-muted">Meta Box</a>
<a href=https://www.codetab.org/tutorial/wordpress-plugin-development/admin-module-custom-posts/save-post/ class="toc-page dropdown-item text-wrap text-muted">Save Post</a></div></div><div class="dropdown show mt-2"><a class="no-collapse-on-click card-link toc-section text-dark" href=#tutorial-wordpress-plugin-development-frontend id=dropdownheader data-toggle=collapse aria-haspopup=true aria-expanded=false>Frontend</a><div id=tutorial-wordpress-plugin-development-frontend class=collapse><a href=https://www.codetab.org/tutorial/wordpress-plugin-development/frontend/enqueue-scripts/ class="toc-page dropdown-item text-wrap text-muted">Plugin Enqueue Scripts</a>
<a href=https://www.codetab.org/tutorial/wordpress-plugin-development/frontend/pass-data-to-javascript/ class="toc-page dropdown-item text-wrap text-muted">Pass Data to JavaScript</a>
<a href=https://www.codetab.org/tutorial/wordpress-plugin-development/frontend/debug-info/ class="toc-page dropdown-item text-wrap text-muted">Debug Info</a></div></div><div class="dropdown show mt-2"><a class="no-collapse-on-click card-link toc-section text-dark" href=#tutorial-wordpress-plugin-development-ajax id=dropdownheader data-toggle=collapse aria-haspopup=true aria-expanded=false>Ajax</a><div id=tutorial-wordpress-plugin-development-ajax class=collapse><a href=https://www.codetab.org/tutorial/wordpress-plugin-development/ajax/wordpress-ajax/ class="toc-page dropdown-item text-wrap text-muted">Ajax</a>
<a href=https://www.codetab.org/tutorial/wordpress-plugin-development/ajax/chart-page/ class="toc-page dropdown-item text-wrap text-muted">Chart Page</a>
<a href=https://www.codetab.org/tutorial/wordpress-plugin-development/ajax/google-charts/ class="toc-page dropdown-item text-wrap text-muted">Google Charts</a></div></div><div class="dropdown show mt-2"><a class="no-collapse-on-click card-link toc-section text-dark" href=#tutorial-wordpress-plugin-development-internationalization id=dropdownheader data-toggle=collapse aria-haspopup=true aria-expanded=false>Internationalization</a><div id=tutorial-wordpress-plugin-development-internationalization class=collapse><a href=https://www.codetab.org/tutorial/wordpress-plugin-development/internationalization/internationalize/ class="toc-page dropdown-item text-wrap text-muted">Internationalization</a>
<a href=https://www.codetab.org/tutorial/wordpress-plugin-development/internationalization/localization/ class="toc-page dropdown-item text-wrap text-muted">Localization</a></div></div><div class="dropdown show mt-2"><a class="no-collapse-on-click card-link toc-section text-dark" href=#tutorial-wordpress-plugin-development-activation id=dropdownheader data-toggle=collapse aria-haspopup=true aria-expanded=false>Activation</a><div id=tutorial-wordpress-plugin-development-activation class=collapse><a href=https://www.codetab.org/tutorial/wordpress-plugin-development/activation/plugin-activation/ class="toc-page dropdown-item text-wrap text-muted">Activation</a>
<a href=https://www.codetab.org/tutorial/wordpress-plugin-development/activation/enable-multisite/ class="toc-page dropdown-item text-wrap text-muted">Multi site</a>
<a href=https://www.codetab.org/tutorial/wordpress-plugin-development/activation/multisite-activation/ class="toc-page dropdown-item text-wrap text-muted">Multi site Activation</a>
<a href=https://www.codetab.org/tutorial/wordpress-plugin-development/activation/plugin-deactivation/ class="toc-page dropdown-item text-wrap text-muted">Deactivation</a>
<a href=https://www.codetab.org/tutorial/wordpress-plugin-development/activation/plugin-uninstall/ class="toc-page dropdown-item text-wrap text-muted">Uninstall</a></div></div><div class="dropdown show mt-2"><a class="no-collapse-on-click card-link toc-section text-dark" href=#tutorial-wordpress-plugin-development-unit-test id=dropdownheader data-toggle=collapse aria-haspopup=true aria-expanded=false>Testing</a><div id=tutorial-wordpress-plugin-development-unit-test class=collapse><a href=https://www.codetab.org/tutorial/wordpress-plugin-development/unit-test/plugin-unit-testing/ class="toc-page dropdown-item text-wrap text-muted">Unit Test</a>
<a href=https://www.codetab.org/tutorial/wordpress-plugin-development/unit-test/setup/ class="toc-page dropdown-item text-wrap text-muted">Test Setup</a>
<a href=https://www.codetab.org/tutorial/wordpress-plugin-development/unit-test/simple-unit-tests/ class="toc-page dropdown-item text-wrap text-muted">Simple Unit Tests</a>
<a href=https://www.codetab.org/tutorial/wordpress-plugin-development/unit-test/scripts-actions-filters/ class="toc-page dropdown-item text-wrap text-muted">Unit Test Scripts, Actions, Filters</a>
<a href=https://www.codetab.org/tutorial/wordpress-plugin-development/unit-test/advanced-unit-tests/ class="toc-page dropdown-item text-wrap text-muted">Advanced Unit Tests</a>
<a href=https://www.codetab.org/tutorial/wordpress-plugin-development/unit-test/internationalization-functions/ class="toc-page dropdown-item text-wrap text-muted">Test Internationalization Functions</a>
<a href=https://www.codetab.org/tutorial/wordpress-plugin-development/unit-test/ajax/ class="toc-page dropdown-item text-wrap text-muted">Ajax Unit Tests</a>
<a href=https://www.codetab.org/tutorial/wordpress-plugin-development/unit-test/multisite-plugin-unit-tests/ class="toc-page dropdown-item text-wrap text-muted">Multi site Plugin Unit Tests</a></div></div></div></div></nav></nav></div></aside><div id=contentbar class=col-md-8><div id=share class="row justify-content-end"><div title=twitter><a href="https://twitter.com/intent/tweet?url=https://www.codetab.org/tutorial/wordpress-plugin-development/admin-module-settings/settings-api/&amp;text=Settings%20API%20-%20WordPress%20Plugin%20Development%20-%20CodeTab" target=_blank rel=noopener><i class="icon-twitter-squared text-secondary"></i></a></div><div title=facebook><a href="https://www.facebook.com/sharer.php?u=https://www.codetab.org/tutorial/wordpress-plugin-development/admin-module-settings/settings-api/&amp;t=Settings%20API%20-%20WordPress%20Plugin%20Development%20-%20CodeTab" target=_blank rel=noopener><i class="icon-facebook-squared text-secondary"></i></a></div><div title=linkedin><a href="https://www.linkedin.com/shareArticle?url=https://www.codetab.org/tutorial/wordpress-plugin-development/admin-module-settings/settings-api/&amp;title=Settings%20API%20-%20WordPress%20Plugin%20Development%20-%20CodeTab" target=_blank rel=noopener><i class="icon-linkedin-squared text-secondary"></i></a></div><div title=email><a href="mailto:?subject=Settings%20API%20-%20WordPress%20Plugin%20Development%20-%20CodeTab&amp;body=https://www.codetab.org/tutorial/wordpress-plugin-development/admin-module-settings/settings-api/" target=_blank rel=noopener><i class="icon-mail-squared text-secondary"></i></a></div><div title=whatsapp><a href="https://web.whatsapp.com/send?text=Settings%20API%20-%20WordPress%20Plugin%20Development%20-%20CodeTab%20https://www.codetab.org/tutorial/wordpress-plugin-development/admin-module-settings/settings-api/" target=_blank rel=noopener><i class="icon-whatsapp text-secondary"></i></a></div><div title=reddit><a href="https://reddit.com/submit?url=https://www.codetab.org/tutorial/wordpress-plugin-development/admin-module-settings/settings-api/&amp;title=Settings%20API%20-%20WordPress%20Plugin%20Development%20-%20CodeTab" target=_blank rel=noopener><i class="icon-reddit-alien text-secondary"></i></a></div><i class="icon-blank ctab-transparent"></i></div><div class=row><main id=content class="col-md-11 post-basic"><h2 id=62wordpress-settings-api>6.2. WordPress Settings API</h2><p>In the previous blog, we add a sub menu to admin menu to accept common
settings from users. In this blog, we add sections and fields to the
menu page.</p><p><a href=http://codex.wordpress.org/Settings_API target=_blank>WordPress Settings API</a> allows
developers to add form pages to Admin screen by defining pages, sections
and fields and partially automates the form and data management.</p><p>But before that, we briefly touch upon WordPress Options API, which we
use to store plugins&rsquo; settings or options in WordPress database.</p><h3 id=wordpress-options>WordPress Options</h3><figure class=text-center><img class="lazy img-fluid" data-src=/tutorial/wordpress-plugin-development/media/wp-pd-sos-settings.png alt="WordPress Settings API - Share on Social options"></figure><p><a href=http://codex.wordpress.org/Options_API target=_blank>WordPress Options API</a> is an easy way to store plugins data in WordPress database. With WordPress Options we can add, delete, update data which is stored in wp_options table as key and value pairs. Some of the frequently used functions to manage WordPress Options are</p><ul><li><p><a href=http://codex.wordpress.org/Function_Reference/get_option target=_blank>get_option()</a></p><ul><li>read option from database.</li></ul></li><li><p><a href=http://codex.wordpress.org/Function_Reference/add_option target=_blank>add_option()</a></p><ul><li>save option to database.</li></ul></li><li><p><a href=http://codex.wordpress.org/Function_Reference/update_option target=_blank>update_option()</a></p></li><li><p><a href=http://codex.wordpress.org/Function_Reference/delete_option target=_blank>delete_option()</a></p></li></ul><p>In Share on Social Plugin, we use an assoc array to hold Facebook App
ID, Google Client ID and Debug boolean flag. This array is saved as as
WordPress Options under option name <strong>sos_common_options</strong>.</p><p><code>share-on-social/admin/class-options.php</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>class</span> <span class=nc>Sos_Options</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>setup</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=o>....</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>add_action</span><span class=p>(</span> <span class=s1>&#39;admin_init&#39;</span><span class=p>,</span><span class=k>array</span><span class=p>(</span><span class=nv>$this</span><span class=p>,</span><span class=s1>&#39;init_common_options&#39;</span><span class=p>)</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>init_common_options</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nv>$option_group</span> <span class=o>=</span> <span class=s1>&#39;sos_common_options&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// no options - create them.
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span> <span class=k>false</span> <span class=o>==</span> <span class=nx>get_option</span><span class=p>(</span> <span class=nv>$option_group</span> <span class=p>)</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>add_option</span><span class=p>(</span> <span class=nv>$option_group</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nv>$options</span> <span class=o>=</span> <span class=nx>get_option</span><span class=p>(</span> <span class=nv>$option_group</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span> <span class=k>false</span> <span class=o>==</span> <span class=nx>isset</span><span class=p>(</span> <span class=nv>$options</span><span class=o>&lt;</span><span class=nx>a</span> <span class=nx>href</span><span class=o>=</span><span class=s2>&#34;http://codex.wordpress.org/Function_Reference/add_settings_section&#34;</span> <span class=nx>target</span><span class=o>=</span><span class=s2>&#34;_blank&#34;</span><span class=o>&gt;</span><span class=s1>&#39;fbappid&#39;</span><span class=p>])</span> <span class=p>)</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$options</span><span class=p>[</span><span class=s1>&#39;fbappid&#39;</span><span class=p>])</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=o>...</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></div><p>In <code>setup()</code> we add <code>init_common_options()</code> method as action to
<strong>admin_init</strong> hook. WordPress executes this method when it reaches
admin_init stage.</p><p>In init_common_options() method, we check whether option
sos_common_options already exists in database using get_option()
function. If it doesn&rsquo;t exists, then we add an empty option using
add_option() method. If exists, then we get the option value and assign
it $options. Next, we check whether $options[&lsquo;fbappid&rsquo;] is set and if
not set then set it to an empty string. We do similarly for Google
Client ID and Debug flag. At this stage, $options array is primed either
with empty strings or if option exists, then the values read from the
database.</p><p>Before we can display the options in a form, we have to register them
with WordPress as fields using WordPress Settings API.</p><div>&nbsp;</div><div>&nbsp;</div><h3 id=wordpress-settings-api>WordPress Settings API</h3><p>To register or add fields, use WordPress Settings API functions -
<a href=http://codex.wordpress.org/Function_Reference/add_settings_section target=_blank>add_settings_section()</a> and
<a href=http://codex.wordpress.org/Function_Reference/add_settings_field target=_blank>add_settings_field().</a>.</p><p>The following snippet shows how FB App ID field is added as settings.</p><p><code>share-on-social/admin/class-options.php</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>init_common_options</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nv>$option_group</span> <span class=o>=</span> <span class=s1>&#39;sos_common_options&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>$section</span> <span class=o>=</span> <span class=s1>&#39;sos_common_options_section&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// no options - create them.
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span> <span class=k>false</span> <span class=o>==</span> <span class=nx>get_option</span><span class=p>(</span> <span class=nv>$option_group</span> <span class=p>)</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>add_option</span><span class=p>(</span> <span class=nv>$option_group</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nv>$options</span> <span class=o>=</span> <span class=nx>get_option</span><span class=p>(</span> <span class=nv>$option_group</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span> <span class=k>false</span> <span class=o>==</span> <span class=nx>isset</span><span class=p>(</span> <span class=nv>$options</span><span class=o>&lt;</span><span class=nx>a</span> <span class=nx>href</span><span class=o>=</span><span class=s2>&#34;http://codex.wordpress.org/Function_Reference/register_setting&#34;</span> <span class=nx>target</span><span class=o>=</span><span class=s2>&#34;_blank&#34;</span><span class=o>&gt;</span><span class=s1>&#39;fbappid&#39;</span><span class=p>])</span> <span class=p>)</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$options</span><span class=p>[</span><span class=s1>&#39;fbappid&#39;</span><span class=p>])</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>add_settings_section</span><span class=p>(</span> <span class=nv>$section</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=nv>$option_group</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nv>$label</span> <span class=o>=</span> <span class=nx>__</span><span class=p>(</span> <span class=s1>&#39;Facebook App ID&#39;</span><span class=p>,</span> <span class=s1>&#39;sos-domain&#39;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>add_settings_field</span><span class=p>(</span> <span class=s1>&#39;fbappid&#39;</span><span class=p>,</span> <span class=nv>$label</span><span class=p>,</span> <span class=k>array</span><span class=p>(</span><span class=nv>$this</span><span class=p>,</span><span class=s1>&#39;textinput&#39;</span><span class=p>),</span> <span class=nv>$option_group</span><span class=p>,</span> <span class=nv>$section</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                            <span class=k>array</span><span class=p>(</span><span class=s1>&#39;id&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;fbappid&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                  <span class=s1>&#39;name&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;sos_common_options[fbappid]&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                  <span class=s1>&#39;value&#39;</span> <span class=o>=&gt;</span> <span class=nv>$options</span><span class=p>[</span><span class=s1>&#39;fbappid&#39;</span><span class=p>])</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// similarly register other fields of the page
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=c1>// finally
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>register_setting</span><span class=p>(</span> <span class=nv>$option_group</span><span class=p>,</span> <span class=nv>$option_group</span><span class=p>,</span><span class=k>array</span><span class=p>(</span><span class=nv>$this</span><span class=p>,</span><span class=s1>&#39;sanitize_options&#39;</span><span class=p>)</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></div><p>Section is just grouping of fields. We name section as
<strong>sos_common_options_section</strong> and add a page
<strong>sos_common_options</strong> to it. To the page, we add FB App ID field
using add_settings_field() which takes following arguments.</p><ul><li><p><strong>id</strong> - we use fbappid as the id of the field.</p></li><li><p><strong>title</strong> - field label.</p></li><li><p><strong>callback function</strong> - for the field, we need a text input field to
accept the app id from the user and we pass textinput() method as
the callback function which renders the text input field.</p></li><li><p><strong>page</strong> - to which this field belongs.</p></li><li><p><strong>section</strong> - to which this field belongs. this is optional.</p></li><li><p><strong>args</strong> - use this to pass arguments to callback function.</p></li></ul><p>This function just adds or registers field with WordPress and it doesn&rsquo;t
render. Instead, for the each field a callback function and arguments to
callback are specified. In the above code, we have attached textinput()
method as callback with argument <code>array('id' => 'fbappid', 'name' => 'sos_common_options[fbappid]', 'value' => $options['fbappid'])</code>. Actual
rendering happens much later when user clicks the menu item, WordPress
calls the textinput() method with the said argument which renders the
text input field for FB App ID.</p><p><code>share-on-social/admin/class-options.php</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl>    <span class=k>function</span> <span class=nf>textinput</span> <span class=p>(</span> <span class=nv>$args</span><span class=p>,</span> <span class=nv>$echo</span> <span class=o>=</span> <span class=k>true</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$html</span> <span class=o>=</span> <span class=s1>&#39;&lt;input class=&#34;text&#34; type=&#34;text&#34; id=&#34;&#39;</span> <span class=o>.</span> <span class=nv>$args</span><span class=p>[</span> <span class=s1>&#39;id&#39;</span> <span class=p>]</span> <span class=o>.</span>
</span></span><span class=line><span class=cl>                 <span class=s1>&#39;&#34; name=&#34;&#39;</span> <span class=o>.</span> <span class=nv>$args</span><span class=p>[</span> <span class=s1>&#39;name&#39;</span> <span class=p>]</span> <span class=o>.</span> <span class=s1>&#39;&#34; size=&#34;30&#34; value=&#34;&#39;</span> <span class=o>.</span>
</span></span><span class=line><span class=cl>                 <span class=nv>$args</span><span class=p>[</span> <span class=s1>&#39;value&#39;</span> <span class=p>]</span> <span class=o>.</span> <span class=s1>&#39;&#34;/&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span> <span class=nv>$echo</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>echo</span> <span class=nv>$html</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nv>$html</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></div><p>Method <code>textinput() </code>is just a helper method that echo the HTML input
element. Parameter $args holds the array passed by
add_settings_field() and it used as attributes to input element which
are</p><ul><li><p>id - we use fbappid as id.</p></li><li><p>name - string &lsquo;sos_common_options[fbappid]&rsquo; tells WordPress
Settings API that on form submit, value of this element should be
saved in option named sos_common_options and at assoc index
&lsquo;fbappid&rsquo; .</p></li><li><p>value - $options[&lsquo;fbappid&rsquo;] is set as value of text input field.</p></li></ul><p>Similarly, we add other fields Google Client ID and Debug flag. For the
last one, we use <code>checkbox()</code> method as callback to display the HTML
checkbox.</p><p>Finally, we register one more callback function with
<a href=http://codex.wordpress.org/Function_Reference/register_setting target=_blank>register_setting()</a> which is used to register <code>sanitize_options()</code> method as callback. When user submit the page, WordPress uses the callback to sanitize the values entered by the user.</p><p><code>share-on-social/admin/class-options.php</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl>    <span class=k>function</span> <span class=nf>sanitize_options</span> <span class=p>(</span> <span class=nv>$input</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nv>$output</span> <span class=o>=</span> <span class=k>array</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>foreach</span> <span class=p>(</span> <span class=nv>$input</span> <span class=k>as</span> <span class=nv>$key</span> <span class=o>=&gt;</span> <span class=nv>$val</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span> <span class=nx>isset</span><span class=p>(</span> <span class=nv>$input</span><span class=o>&lt;</span><span class=nx>a</span> <span class=nx>href</span><span class=o>=</span><span class=s2>&#34;http://codex.wordpress.org/Function_Reference/wp_filter_nohtml_kses&#34;</span> <span class=nx>target</span><span class=o>=</span><span class=s2>&#34;_blank&#34;</span><span class=o>&gt;</span> <span class=nv>$key</span> <span class=p>]</span> <span class=p>)</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nv>$output</span><span class=p>[</span> <span class=nv>$key</span> <span class=p>]</span> <span class=o>=</span> <span class=nx>wp_filter_nohtml_kses</span><span class=p>(</span> <span class=nv>$input</span><span class=p>[</span> <span class=nv>$key</span> <span class=p>]</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>apply_filters</span><span class=p>(</span> <span class=s1>&#39;sanitize_options&#39;</span><span class=p>,</span> <span class=nv>$output</span><span class=p>,</span> <span class=nv>$input</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></div><p>When options are about to be saved to database, WordPress calls this
method with options as array of key and value pairs. We use WordPress
function
<a href=http://codex.wordpress.org/Function_Reference/wp_filter_nohtml_kses target=_blank>wp_filter_nohtml_kses()</a> to strip scripts or tags in input value so that they don&rsquo;t get into database.</p><script>console.log("slot C")</script><p>Lot of things going on here. Let&rsquo;s recap what we have done so far.</p><ol><li><p>add a sub menu and registered a page for that menu item.</p></li><li><p>tell WP to add some fields to the page.</p></li><li><p>tell WP which method to call to render each field and what args to
pass on to rendering methods.</p></li><li><p>tell WP which method to sanitize the option when saving to database.</p></li></ol><p>At this point, WordPress knows about the fields to display and how to
render them. It also knows how to sanitize and save them. But it doesn&rsquo;t
know how to render the page.</p><p>Last thing we have to do to complete this menu item is tell WP how to
render the page. In the next section, we show how to render page with
WordPress Settings API.</p></main></div></div><aside id=sidebar-right class=col-md-1><div class="row my-5 justify-content-center"></div></aside></div></div><footer class="container-fluid mt-5"><div class=row><div class="col ml-auto"><div class="row mb-1 ml-2"><a class=text-muted href=/privacy-policy>Privacy</a></div><div class="row text-muted mb-2 ml-2"><span>&copy; 2019 &#183;Powered by <a href=https://gohugo.io target=_blank rel=noopener>Hugo</a></span></div></div><div class="col mr-auto"><span class=float-right><a href=# id=back_to_top><i class="icon-up-open h1 text-secondary"></i></a></span></div></div></footer><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<script src=/js/vendor.min.e0afe83ba5579b9676fc5f849c1becff1395739520a7c0bc45535f04acd819c3.js></script></body></html>