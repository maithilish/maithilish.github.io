<!DOCTYPE html>
<html lang="en-us">

<head><meta charset="utf-8">
<meta name="description" content="Unit Test Scripts, Actions, Filters Tutorial shows how to write unit tests for plugin methods that work with WordPress Enqueue Scripts, Actions and Filters.">
<meta name="author" content="Maithilish">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">



<script async src="https://www.googletagmanager.com/gtag/js?id=UA-42139846-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-42139846-3');
</script>

<script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "https://google.com/article"
        },
        "articleSection" : "tutorial",
        "name" : "Unit Test Scripts Action Filter - WordPress Plugin Development - CodeTab",
        "headline" : "Unit Test Scripts Action Filter - WordPress Plugin Development - CodeTab",
        "url" : "https://www.codetab.org/tutorial/wordpress-plugin-development/unit-test/scripts-actions-filters/",
        "description" : "Unit Test Scripts, Actions, Filters Tutorial shows how to write unit tests for plugin methods that work with WordPress Enqueue Scripts, Actions and Filters.",
        "inLanguage" : "en",
        "image": "https://www.codetab.org/logo.jpg",
        "author" : "Maithilish",
        "creator" : "Maithilish",
        "publisher": {
            "@type": "Organization",
            "name": "Maithilish",
            "url": "https://www.codetab.org/",
            "logo": {
               "@type": "ImageObject",
               "url": "https://www.codetab.org/logo.png",
               "width":"200",
               "height":"200"
            }
        },
        "copyrightHolder" : "Maithilish",
        "copyrightYear" : "2019",
        "datePublished": "2019-01-11T13:30:00+0530",
        "dateModified" : "2019-01-11T13:30:00+0530",
        "wordCount" : "1185",
        "keywords" : [ "unit test scripts, actions, filters","Blog" ]
    }
</script>
<link rel="icon" href="/favicon.ico">






<link rel="stylesheet" href="/css/vendor.min.e7fd2d89f73c680873529a110a9007503a1bda864a3a3a6c53c4eb02a54c35eb.css" integrity="sha256-5/0tifc8aAhzUpoRCpAHUDob2oZKOjpsU8TrAqVMNes=">

<title>Unit Test Scripts Action Filter - WordPress Plugin Development - CodeTab</title></head>

<body id="top"><header><nav id="navbar-main" class="navbar fixed-top navbar-light navbar-expand-lg bg-white border-bottom shadow-sm">

    <div class="container-fluid">

        
        <a class="navbar-brand" href="/">Codetab</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbar"
            aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        
        <div class="collapse navbar-collapse" id="navbar">

            
            
            <ul class="navbar-nav ml-auto">
                

                

                
                
                
                
                

                <li class="nav-item">
                    <a class="nav-link" href="/#tutorials"  >
                        
                        <span>Home</span>
                        
                    </a>
                </li>

                
                

                

                
                
                
                
                

                <li class="nav-item">
                    <a class="nav-link" href="/#projects"  >
                        
                        <span>Projects</span>
                        
                    </a>
                </li>

                
                

                

                
                
                

                <li class="nav-item">
                    <a class="nav-link" href="/post"  >
                        
                        <span>Posts</span>
                        
                    </a>
                </li>

                
                

                

                
                
                
                
                

                <li class="nav-item">
                    <a class="nav-link" href="/#about"  >
                        
                        <span>About</span>
                        
                    </a>
                </li>

                
                

            </ul>

        </div>
    </div>
</nav></header>

<div class="container-fluid">
  <div class="row">&nbsp;</div>

  <div class="row">
    
    <aside id="sidebar" class="col-md-3">
      <div class="row"><nav id="navbar-side" class="bg-light text-secondary">

    
    

    

    
    

    

    <h4 class="text-muted bg-white pl-2">WP Plugin Development</h4>

    <nav class="navbar navbar-light bg-white navbar-expand-md">

        <button class="navbar-toggler ml-auto" type="button" data-toggle="collapse" data-target="#bookmenu"
            aria-controls="bookmenu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bookmenu">
            <div>
                
                









<div id="WordPress Plugin Development - CodeTab">
    
    <div>
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/introduction/"
            class="toc-page text-wrap text-muted ">
            Introduction
        </a>
    </div>
    
    <div>
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/install-locally/"
            class="toc-page text-wrap text-muted ">
            Install Locally
        </a>
    </div>
    
    <div>
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/simple-plugin/"
            class="toc-page text-wrap text-muted ">
            Simple Plugin
        </a>
    </div>
    
    <div>
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/shortcode/"
            class="toc-page text-wrap text-muted ">
            Shortcode
        </a>
    </div>
    
    <div>
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/plugin-structure/"
            class="toc-page text-wrap text-muted ">
            Plugin Structure
        </a>
    </div>
    
    <div>
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/plugin-main-file/"
            class="toc-page text-wrap text-muted ">
            Main File
        </a>
    </div>
    
    <div>
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/hooks-actions-filters/"
            class="toc-page text-wrap text-muted ">
            Hooks, Actions, Filters
        </a>
    </div>
    
</div>







<div class="dropdown show mt-2">
    <a class="no-collapse-on-click card-link toc-section text-dark" href="#tutorial-wordpress-plugin-development-admin-module-settings" id="dropdownheader"
        data-toggle="collapse" aria-haspopup="true" aria-expanded="false">
        Admin Module - Settings
    </a>
    
    <div id="tutorial-wordpress-plugin-development-admin-module-settings" class="collapse">
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/admin-module-settings/add-menu/"
            class="toc-page dropdown-item text-wrap text-muted">
            Add Menu
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/admin-module-settings/settings-api/"
            class="toc-page dropdown-item text-wrap text-muted">
            Settings API
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/admin-module-settings/options-page/"
            class="toc-page dropdown-item text-wrap text-muted">
            Options Page
        </a>
        
        
        
        
    </div>
</div>




<div class="dropdown show mt-2">
    <a class="no-collapse-on-click card-link toc-section text-dark" href="#tutorial-wordpress-plugin-development-admin-module-custom-posts" id="dropdownheader"
        data-toggle="collapse" aria-haspopup="true" aria-expanded="false">
        Admin Module - Posts
    </a>
    
    <div id="tutorial-wordpress-plugin-development-admin-module-custom-posts" class="collapse">
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/admin-module-custom-posts/post-type/"
            class="toc-page dropdown-item text-wrap text-muted">
            Custom Post Type
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/admin-module-custom-posts/meta-box/"
            class="toc-page dropdown-item text-wrap text-muted">
            Meta Box
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/admin-module-custom-posts/save-post/"
            class="toc-page dropdown-item text-wrap text-muted">
            Save Post
        </a>
        
        
        
        
    </div>
</div>




<div class="dropdown show mt-2">
    <a class="no-collapse-on-click card-link toc-section text-dark" href="#tutorial-wordpress-plugin-development-frontend" id="dropdownheader"
        data-toggle="collapse" aria-haspopup="true" aria-expanded="false">
        Frontend
    </a>
    
    <div id="tutorial-wordpress-plugin-development-frontend" class="collapse">
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/frontend/enqueue-scripts/"
            class="toc-page dropdown-item text-wrap text-muted">
            Plugin Enqueue Scripts
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/frontend/pass-data-to-javascript/"
            class="toc-page dropdown-item text-wrap text-muted">
            Pass Data to JavaScript
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/frontend/debug-info/"
            class="toc-page dropdown-item text-wrap text-muted">
            Debug Info
        </a>
        
        
        
        
    </div>
</div>




<div class="dropdown show mt-2">
    <a class="no-collapse-on-click card-link toc-section text-dark" href="#tutorial-wordpress-plugin-development-ajax" id="dropdownheader"
        data-toggle="collapse" aria-haspopup="true" aria-expanded="false">
        Ajax
    </a>
    
    <div id="tutorial-wordpress-plugin-development-ajax" class="collapse">
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/ajax/wordpress-ajax/"
            class="toc-page dropdown-item text-wrap text-muted">
            Ajax
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/ajax/chart-page/"
            class="toc-page dropdown-item text-wrap text-muted">
            Chart Page
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/ajax/google-charts/"
            class="toc-page dropdown-item text-wrap text-muted">
            Google Charts
        </a>
        
        
        
        
    </div>
</div>




<div class="dropdown show mt-2">
    <a class="no-collapse-on-click card-link toc-section text-dark" href="#tutorial-wordpress-plugin-development-internationalization" id="dropdownheader"
        data-toggle="collapse" aria-haspopup="true" aria-expanded="false">
        Internationalization
    </a>
    
    <div id="tutorial-wordpress-plugin-development-internationalization" class="collapse">
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/internationalization/internationalize/"
            class="toc-page dropdown-item text-wrap text-muted">
            Internationalization
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/internationalization/localization/"
            class="toc-page dropdown-item text-wrap text-muted">
            Localization
        </a>
        
        
        
        
    </div>
</div>




<div class="dropdown show mt-2">
    <a class="no-collapse-on-click card-link toc-section text-dark" href="#tutorial-wordpress-plugin-development-activation" id="dropdownheader"
        data-toggle="collapse" aria-haspopup="true" aria-expanded="false">
        Activation
    </a>
    
    <div id="tutorial-wordpress-plugin-development-activation" class="collapse">
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/activation/plugin-activation/"
            class="toc-page dropdown-item text-wrap text-muted">
            Activation
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/activation/enable-multisite/"
            class="toc-page dropdown-item text-wrap text-muted">
            Multi site
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/activation/multisite-activation/"
            class="toc-page dropdown-item text-wrap text-muted">
            Multi site Activation
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/activation/plugin-deactivation/"
            class="toc-page dropdown-item text-wrap text-muted">
            Deactivation
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/activation/plugin-uninstall/"
            class="toc-page dropdown-item text-wrap text-muted">
            Uninstall
        </a>
        
        
        
        
    </div>
</div>




<div class="dropdown show mt-2">
    <a class="no-collapse-on-click card-link toc-section text-dark" href="#tutorial-wordpress-plugin-development-unit-test" id="dropdownheader"
        data-toggle="collapse" aria-haspopup="true" aria-expanded="false">
        Testing
    </a>
    
    <div id="tutorial-wordpress-plugin-development-unit-test" class="">
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/unit-test/plugin-unit-testing/"
            class="toc-page dropdown-item text-wrap text-muted">
            Unit Test
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/unit-test/setup/"
            class="toc-page dropdown-item text-wrap text-muted">
            Test Setup
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/unit-test/simple-unit-tests/"
            class="toc-page dropdown-item text-wrap text-muted">
            Simple Unit Tests
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/unit-test/scripts-actions-filters/"
            class="toc-page dropdown-item text-wrap text-danger">
            Unit Test Scripts, Actions, Filters
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/unit-test/advanced-unit-tests/"
            class="toc-page dropdown-item text-wrap text-muted">
            Advanced Unit Tests
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/unit-test/internationalization-functions/"
            class="toc-page dropdown-item text-wrap text-muted">
            Test Internationalization Functions
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/unit-test/ajax/"
            class="toc-page dropdown-item text-wrap text-muted">
            Ajax Unit Tests
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/wordpress-plugin-development/unit-test/multisite-plugin-unit-tests/"
            class="toc-page dropdown-item text-wrap text-muted">
            Multi site Plugin Unit Tests
        </a>
        
        
        
        
    </div>
</div>



                
            </div>
        </div>
    </nav>

</nav>

</div>
    </aside>

    <div id="contentbar" class="col-md-7">
        <div id="share" class="row justify-content-end">





<div title=twitter>
    <a href="https://twitter.com/intent/tweet?url=https://www.codetab.org/tutorial/wordpress-plugin-development/unit-test/scripts-actions-filters/&amp;text=Unit%20Test%20Scripts%20Action%20Filter%20-%20WordPress%20Plugin%20Development%20-%20CodeTab" target="_blank" rel="noopener">
        <i class="icon-twitter-squared text-secondary"></i>
    </a>
</div>




<div title=facebook>
    <a href="https://www.facebook.com/sharer.php?u=https://www.codetab.org/tutorial/wordpress-plugin-development/unit-test/scripts-actions-filters/&amp;t=Unit%20Test%20Scripts%20Action%20Filter%20-%20WordPress%20Plugin%20Development%20-%20CodeTab" target="_blank" rel="noopener">
        <i class="icon-facebook-squared text-secondary"></i>
    </a>
</div>




<div title=linkedin>
    <a href="https://www.linkedin.com/shareArticle?url=https://www.codetab.org/tutorial/wordpress-plugin-development/unit-test/scripts-actions-filters/&amp;title=Unit%20Test%20Scripts%20Action%20Filter%20-%20WordPress%20Plugin%20Development%20-%20CodeTab" target="_blank" rel="noopener">
        <i class="icon-linkedin-squared text-secondary"></i>
    </a>
</div>




<div title=email>
    <a href="mailto:?subject=Unit%20Test%20Scripts%20Action%20Filter%20-%20WordPress%20Plugin%20Development%20-%20CodeTab&amp;body=https://www.codetab.org/tutorial/wordpress-plugin-development/unit-test/scripts-actions-filters/" target="_blank" rel="noopener">
        <i class="icon-mail-squared text-secondary"></i>
    </a>
</div>




<div title=whatsapp>
    <a href="https://web.whatsapp.com/send?text=Unit%20Test%20Scripts%20Action%20Filter%20-%20WordPress%20Plugin%20Development%20-%20CodeTab%20https://www.codetab.org/tutorial/wordpress-plugin-development/unit-test/scripts-actions-filters/" target="_blank" rel="noopener">
        <i class="icon-whatsapp text-secondary"></i>
    </a>
</div>




<div title=reddit>
    <a href="https://reddit.com/submit?url=https://www.codetab.org/tutorial/wordpress-plugin-development/unit-test/scripts-actions-filters/&amp;title=Unit%20Test%20Scripts%20Action%20Filter%20-%20WordPress%20Plugin%20Development%20-%20CodeTab" target="_blank" rel="noopener">
        <i class="icon-reddit-alien text-secondary"></i>
    </a>
</div>




<div title=weibo>
    <a href="https://service.weibo.com/share/share.php?url=https://www.codetab.org/tutorial/wordpress-plugin-development/unit-test/scripts-actions-filters/&amp;title=Unit%20Test%20Scripts%20Action%20Filter%20-%20WordPress%20Plugin%20Development%20-%20CodeTab" target="_blank" rel="noopener">
        <i class="icon-weibo text-secondary"></i>
    </a>
</div>




<i class="icon-blank ctab-transparent"></i></div>
        <div class="row">
          <main id="content" class="col-md-11 post-basic">
            <h2 id="124unit-test-scripts-actions-filters">12.4. Unit Test Scripts, Actions, Filters</h2>
<p>In the previous blog, we saw how to write tests for plugin methods that
returns value or echo output. In this blog, we explore third category of
plugin methods where outcome is tested using corresponding WordPress API
functions.</p>
<p>For example, add_action() which registers an action hook is tested
using WordPress function has_action().</p>
<p>But, before exploring such tests, we briefly explain an utility class
used by Share on Social Plugin test cases to reduce boilerplate code in
tests and also, learn to toggle user capability to test methods which
depends on user capability.</p>
<h3 id="utility-methods-for-tests">Utility Methods for Tests</h3>
<p>To investigate the arrays, fetch object from database and change user
role or capability etc., tests require multiple lines of code. The class
<code>Util</code> defined by <code>share-on-social/tests/phpunit/util/class-util.php</code>,
extracts such redundant boilerplate code into utility methods.</p>
<p>Methods to investigate the multidimensional arrays and check whether
action exists.</p>
<ul>
<li>
<p>has_value() - whether multidimensional array contains a value.</p>
</li>
<li>
<p>has_obj() - whether multidimensional array contains an object of a
class.</p>
</li>
<li>
<p>has_action() - wrapper for WordPress
<a href="http://codex.wordpress.org/Function_Reference/has_action" target="_blank">has_action()</a>
function.</p>
</li>
<li>
<p>has_filter() - wrapper for WordPress
<a href="http://codex.wordpress.org/Function_Reference/has_filter" target="_blank">has_filter()</a>
function.</p>
</li>
<li>
<p>get_action() - returns action array from global array.</p>
</li>
</ul>
<p>Methods to fetch posts and change locale.</p>
<ul>
<li>
<p>get_post_id() - get post id for matching meta key and value.</p>
</li>
<li>
<p>count_posts() - get number of posts of a post type.</p>
</li>
<li>
<p>change_locale() - changes locale for the tests.</p>
</li>
</ul>
<h3 id="toggle-capability">Toggle Capability</h3>
<p><code>Util</code> class also defines methods to manage users and capabilities
within tests.</p>
<ul>
<li>
<p><strong>set_cap()</strong> - enable or disable a capability.</p>
</li>
<li>
<p><strong>set_activate_plugins_cap()</strong> - enable or disable
activate_plugins capability.</p>
</li>
<li>
<p><strong>set_admin_role()</strong> - enable or disable admin role to an user.</p>
</li>
</ul>
<p>In many of the tests, setUp() method uses following constructs to set
the user and capability to run the tests.</p>
<p><code>share-on-social/tests/phpunit/tests/test-options.php</code></p>
<div class="highlight"><pre class="chroma"><code class="language-php" data-lang="php">class Test_Sos_Options extends WP_UnitTestCase {

    public function setup () {
        parent::setup();  
        ....
        wp_set_current_user( 1 );
        Util::set_admin_role( true );
    }
</code></pre></div><p>Having gone through the utility class and its methods, let&rsquo;s get back to
the tests that uses WordPress API functions to assert the outcome of
method under test.</p>


<div>&nbsp;</div>

<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-1281079745125126"
     data-ad-slot="6135368983"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<div>&nbsp;</div>



<h3 id="test-actions-and-filters">Test Actions and Filters</h3>
<p>In Share on Social Plugin classes we use setup() method to add actions
and filters.</p>
<p>For example, <code>Sos_Options::setup()</code> method adds actions for
<strong>admin_init</strong> and <strong>admin_menu</strong> hooks.</p>
<p><code>share-on-social/admin/class-options.php</code></p>
<div class="highlight"><pre class="chroma"><code class="language-php" data-lang="php">class Sos_Options {

    public function setup () {
        add_action( &#39;admin_init&#39;, 
                array( $this,&#39;init_common_options&#39; ) );
        add_action( &#39;admin_menu&#39;, 
                array( $this,&#39;register_settings_page&#39; ) );
    }
</code></pre></div><p>We test actions in <code>Test_Sos_Options</code> using utility method
<code>Util::has_action()</code>.</p>
<p><code>share-on-social/tests/phpunit/tests/test-options.php</code></p>
<div class="highlight"><pre class="chroma"><code class="language-php" data-lang="php">class Test_Sos_Options extends WP_UnitTestCase {

    public function test_setup () {
        $this-&gt;assertFalse( 
           Util::has_action( &#39;admin_init&#39;, $this-&gt;sos_options,&#39;init_common_options&#39; ) );
        $this-&gt;assertFalse( 
           Util::has_action( &#39;admin_menu&#39;, $this-&gt;sos_options,&#39;register_settings_page&#39; ) );
        
        $this-&gt;sos_options-&gt;setup();
        
        $this-&gt;assertTrue( 
           Util::has_action( &#39;admin_init&#39;, $this-&gt;sos_options, &#39;init_common_options&#39; ) );
        $this-&gt;assertTrue( 
           Util::has_action( &#39;admin_menu&#39;, $this-&gt;sos_options, &#39;register_settings_page&#39; ) );
    }
</code></pre></div><p>In <code>Test_Sos_Options::test_setup()</code>, we first test that admin_init and
admin_menu hooks&rsquo; actions are not set. Next, we call method under test
with $this-&gt;sos_options-&gt;setup(). Finally, we test whether
admin_init has action pointing to <code>Sos_Option::init_common_options()</code>
method. For this, we use <code>Util::has_action()</code> which is wrapper for
WordPress function
<a href="http://codex.wordpress.org/Function_Reference/has_action" target="_blank">has_action()</a>.
Similarly we test admin_menu action.</p>
<p>Filters are tested, in same fashion, using <code>Util::has_filter()</code> method
which is wrapper for WordPress function
<a href="http://codex.wordpress.org/Function_Reference/has_filter" target="_blank">has_filter()</a>.</p>
<p><strong>Demarcate Unit Tests</strong></p>
<p>Is it necessary to test the outcome of action or filter. No, remember
that we unit test the plugin and not the WordPress core. It is
sufficient to test whether action is registered for the hook and
thereafter, it is responsibility of WordPress core to handle the action.</p>
<h3 id="test-enqueue-scripts">Test Enqueue Scripts</h3>
<p>Next type of tests are related to enqueue of plugin scripts and styles.
Share on Social Plugin enqueues couple of scripts and a style sheet in
<code>Sos_Frontend::add_sos_scripts()</code> method.</p>
<p><code>share-on-social/frontend/class-frontend.php</code></p>
<div class="highlight"><pre class="chroma"><code class="language-php" data-lang="php">    function add_sos_scripts () {
        ....
        wp_register_style( &#39;sos_style&#39;, SOS_URL . &#39;/css/style.css&#39; );
        wp_register_script( &#39;sos_script&#39;, SOS_URL . &#39;/js/share.js&#39;, 
                            array(&#39;jquery&#39;), &#39;&#39;, true );
     
        if ( has_shortcode( $post-&gt;post_content, $this-&gt;sos_shortcode ) ) {
            wp_enqueue_style( &#39;sos_style&#39; );
            wp_enqueue_script( &#39;sos_script&#39; );
            ....
        }
     }
</code></pre></div><p>The method, registers the script and stylesheets and if, share-on-social
shortcode exists in the post, then it enqueue them. WordPress functions
<a href="http://codex.wordpress.org/Function_Reference/wp_script_is" target="_blank">wp_script_is()</a>
and
<a href="http://codex.wordpress.org/Function_Reference/wp_style_is" target="_blank">wp_style_is()</a>
are useful to check whether scripts and stylesheets are registered or
enqueued.</p>
<p><code>share-on-social/tests/phpunit/tests/test-frontend.php</code></p>
<div class="highlight"><pre class="chroma"><code class="language-php" data-lang="php">    public function test_add_sos_scripts () {
        // if no shortcode 
        $this-&gt;frontend-&gt;add_sos_scripts();
        
        $this-&gt;assertTrue( wp_style_is( &#39;sos_style&#39;, &#39;registered&#39; ) );
        $this-&gt;assertTrue( wp_script_is( &#39;sos_script&#39;, &#39;registered&#39; ) );
        
        $this-&gt;assertFalse( wp_style_is( &#39;sos_style&#39;, &#39;enqueued&#39; ) );
        $this-&gt;assertFalse( wp_script_is( &#39;sos_script&#39;, &#39;enqueued&#39; ) );
        
        // if shortcode exists 
        $this-&gt;frontend-&gt;setup();
        $this-&gt;frontend-&gt;add_sos_scripts();
        
        $this-&gt;assertTrue( wp_style_is( &#39;sos_style&#39;, &#39;enqueued&#39; ) );
        $this-&gt;assertTrue( wp_script_is( &#39;sos_script&#39;, &#39;enqueued&#39; ) );
    }
</code></pre></div><p>The test calls method under test <code>Sos_Frontend::add_sos_scripts()</code> and
then, assert that script and stylesheet are registered but not enqueued.
Next, it calls <code>Sos_Frontend::setup()</code> to register the shortcode and
assert script and stylesheet are enqueued.</p>
<p><code>Sos_Frontend::add_sos_scripts()</code> enqueues scripts only if post contains
share-on-social shortcode. It is important to understand, from where it
obtains the post, within tests, that has the shortcode. For that, we
need to look at <code>Test_Frontend::setUp() </code>method where the global post is
set.</p>
<p><code>share-on-social/tests/phpunit/tests/test-frontend.php</code></p>
<div class="highlight"><pre class="chroma"><code class="language-php" data-lang="php">class Test_Frontend extends WP_UnitTestCase {
    ....
    public function setUp () {
        parent::setUp();
        
        global $post;
        $this-&gt;create_posts();
        $post = get_post( $this-&gt;child_post_id );
        setup_postdata( $post );
        ....
    }

    private function create_posts () {
        $args = array(
                &#39;post_name&#39; =&gt; &#39;parent test page&#39;,
                &#39;post_title&#39; =&gt; &#39;parent test page title&#39;,
                &#39;post_status&#39; =&gt; &#39;publish&#39;,
                &#39;post_type&#39; =&gt; &#39;page&#39;,
                &#39;post_content&#39; =&gt; &#39;<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;http://codex.wordpress.org/Function_Reference/setup_postdata&#34;</span> <span class="na">target</span><span class="o">=</span><span class="s">&#34;_blank&#34;</span><span class="p">&gt;</span>[share-on-social][/share-on-social]]&#39;
        );
        $post_id = $this-&gt;factory-&gt;post-&gt;create( $args );
        $this-&gt;parent_post_id = $post_id;
        
        $args = array(
                &#39;post_name&#39; =&gt; &#39;child test page&#39;,
                &#39;post_title&#39; =&gt; &#39;child test page title&#39;,
                &#39;post_status&#39; =&gt; &#39;publish&#39;,
                &#39;post_type&#39; =&gt; &#39;page&#39;,
                &#39;post_parent&#39; =&gt; $this-&gt;parent_post_id,
                &#39;post_content&#39; =&gt; &#39;[[share-on-social]test-content[/share-on-social]]&#39;
        );
        $post_id = $this-&gt;factory-&gt;post-&gt;create( $args );
        $this-&gt;child_post_id = $post_id;
    }
</code></pre></div><p>In <code>Test_Frontend::setUp()</code> we call a private method
<code>Test_Frontend::create_posts()</code> to create two posts - actually two pages
and one of which is the parent of other. The args[&lsquo;post_content&rsquo;] of
these pages holds the <strong>share-on-social</strong> shortcode. We use factory
method of <code>WP_UnitTestCase</code> to create the posts.</p>
<p>WordPress holds the current post in the global variable $post. We set
the child page as current post by assigning it to the global $post and
then, update other global variables related to current post, by calling
WordPress function
[setup_postdata()</a>
. In the test, when add_sos_scripts() is called, it obtains the
current post from global $post and checks whether it has the shortcode
or not and enqueue scripts accordingly.</p>


<div>&nbsp;</div>

<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-1281079745125126"
     data-ad-slot="6135368983"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<div>&nbsp;</div>


<p><strong>Factory Methods</strong></p>
<p>WordPress Test Library class <code>WP_UnitTestCase</code> comes with a set of
factory methods to create WordPress objects such as Post, Attachment,
Comment, User, Term, Category and Tag.</p>
<p>For example, in a test case, we use following construct to create a post
object using factory method..</p>
<pre><code class="language-screen" data-lang="screen">        $args = array(
                'post_name' =&gt; 'parent test page',
                'post_title' =&gt; 'parent test page title',
                'post_status' =&gt; 'publish',
                'post_type' =&gt; 'page',
                'post_content' =&gt; '[[share-on-social][/share-on-social]]'
        );
        $post_id = $this-&gt;factory-&gt;post-&gt;create( $args );
</code></pre><p>Similarly, comments can be created through
$this-&gt;factory-&gt;comment-&gt;create( $args ) with appropriate values in
args array.</p>
<p>Factory offers following methods for each type.</p>
<ul>
<li>
<p>create_object ( $args ) - creates an object.</p>
</li>
<li>
<p>update_object ( $user_id, $fields ) - updates an object.</p>
</li>
<li>
<p>get_object_by_id ( $user_id ) - fetch an object.</p>
</li>
</ul>
<p>Apart from these common methods, factory also has additional methods for
some of the types. To know more about the factory, browse the source
file <code>share-on-social/tests/phpunit/includes/factory.php</code></p>
<p>The next blog explains the unit tests for methods which uses WordPress
global variables and also, simulate WordPress admin screens to carry out
tests related to admin modules.</p>

          </main>
        </div>
      </div>
  
    <aside id="sidebar-right" class="col-md-2">
      <div class="row my-5 justify-content-center border">
<div>&nbsp;</div>


<ins class="adsbygoogle"
     style="display:inline-block;width:160px;height:600px"
     data-ad-client="ca-pub-1281079745125126"
     data-ad-slot="8963022093"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<div>&nbsp;</div>
</div>
    </aside>

  </div>

</div>

<footer class="container-fluid mt-5">

    <div class="row">
        <div class="col ml-auto">
            <div class="row mb-1 ml-2">
                <a class="text-muted" href="/privacy-policy">Privacy</a>
            </div>
            <div class="row text-muted mb-2 ml-2">
                <span>&copy; 2019 &middot;Powered by <a href="https://gohugo.io" target="_blank"
                        rel="noopener">Hugo</a></span>
            </div>
        </div>
        <div class="col mr-auto">
            <span class="float-right">
                <a href="#" id="back_to_top">
                    <i class="icon-up-open h1 text-secondary"></i>
                </a>
            </span>
        </div>
    </div>

</footer>

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>








<script src="/js/vendor.min.8489448e4e75ceb388a38abde3871de9485502974c5feddcf04a3d413dc6e103.js"></script>
</body>

</html>