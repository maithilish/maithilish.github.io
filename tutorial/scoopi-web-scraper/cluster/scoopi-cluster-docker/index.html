<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=description content="With Scoopi Cluster you can scale the deployments horizontally by distributing tasks across the cluster nodes"><meta name=author content="Maithilish"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><script async src="https://www.googletagmanager.com/gtag/js?id=G-QYHTHXW09H"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QYHTHXW09H")</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://google.com/article"},"articleSection":"tutorial","name":"Scoopi Cluster - Scoopi Web Scraper - why just scrape when you can scoop","headline":"Scoopi Cluster - Scoopi Web Scraper - why just scrape when you can scoop","url":"https://www.codetab.org/tutorial/scoopi-web-scraper/cluster/scoopi-cluster-docker/","description":"With Scoopi Cluster you can scale the deployments horizontally by distributing tasks across the cluster nodes","inLanguage":"en","image":"https://www.codetab.org/logo.jpg","author":"Maithilish","creator":"Maithilish","publisher":{"@type":"Organization","name":"Maithilish","url":"https://www.codetab.org/","logo":{"@type":"ImageObject","url":"https://www.codetab.org/logo.png","width":"200","height":"200"}},"copyrightHolder":"Maithilish","copyrightYear":"2020","datePublished":"2020-11-05T01:02:00+0530","dateModified":"2020-11-05T01:02:00+0530","wordCount":"560","keywords":["cluster","Blog"]}</script><link rel=icon href=/favicon.ico><link rel=stylesheet href=/css/vendor.min.b34f4a49e8fbf83dd7dd8f945eb35a939c19aa15051f677ac5a9c057ac6c8774.css integrity="sha256-s09KSej7+D3X3Y+UXrNak5wZqhUFH2d6xanAV6xsh3Q="><title>Scoopi Cluster - Scoopi Web Scraper - why just scrape when you can scoop</title>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1281079745125126" crossorigin=anonymous></script></head><body id=top><header><nav id=navbar-main class="navbar fixed-top navbar-light navbar-expand-lg bg-white border-bottom shadow-sm"><div class=container-fluid><a class=navbar-brand href=/>Codetab</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbar aria-controls=navbar aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbar><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=/#tutorials><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/#projects><span>Projects</span></a></li><li class=nav-item><a class=nav-link href=/post><span>Posts</span></a></li><li class=nav-item><a class=nav-link href=/#about><span>About</span></a></li></ul></div></div></nav></header><div class=container-fluid><div class=row>&nbsp;</div><div class=row><aside id=sidebar class=col-md-3><div class=row><nav id=navbar-side class="bg-light text-secondary"><h4 class="text-muted bg-white pl-2">Scoopi Web Scraper</h4><nav class="navbar navbar-light bg-white navbar-expand-md"><button class="navbar-toggler ml-auto" type=button data-toggle=collapse data-target=#bookmenu aria-controls=bookmenu aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=bookmenu><div><div id="Scoopi Web Scraper"><div><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/introduction/ class="toc-page text-wrap text-muted">Introduction</a></div></div><div class="dropdown show mt-2"><a class="no-collapse-on-click card-link toc-section text-dark" href=#tutorial-scoopi-web-scraper-basic id=dropdownheader data-toggle=collapse aria-haspopup=true aria-expanded=false>Basics</a><div id=tutorial-scoopi-web-scraper-basic class=collapse><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/basic/installation-quick-start/ class="toc-page dropdown-item text-wrap text-muted">Installation and Quick Start
</a><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/basic/definition-file/ class="toc-page dropdown-item text-wrap text-muted">Definition File
</a><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/basic/datadef/ class="toc-page dropdown-item text-wrap text-muted">DataDef
</a><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/basic/dimensions/ class="toc-page dropdown-item text-wrap text-muted">Dimensions
</a><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/basic/data-items-dynamic-query/ class="toc-page dropdown-item text-wrap text-muted">Data Items and Dynamic Query
</a><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/basic/index-indexrange-breakafter/ class="toc-page dropdown-item text-wrap text-muted">Index, IndexRange and BreakAfter
</a><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/basic/filters/ class="toc-page dropdown-item text-wrap text-muted">Filters
</a><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/basic/selector-query-analyzer/ class="toc-page dropdown-item text-wrap text-muted">Selector</a></div></div><div class="dropdown show mt-2"><a class="no-collapse-on-click card-link toc-section text-dark" href=#tutorial-scoopi-web-scraper-advanced id=dropdownheader data-toggle=collapse aria-haspopup=true aria-expanded=false>Advanced</a><div id=tutorial-scoopi-web-scraper-advanced class=collapse><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/advanced/multi-dimensions/ class="toc-page dropdown-item text-wrap text-muted">Multi Dimensions
</a><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/advanced/multi-tasks/ class="toc-page dropdown-item text-wrap text-muted">Multi Tasks
</a><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/advanced/workflow-steps-plugins/ class="toc-page dropdown-item text-wrap text-muted">WorkFlow, Steps and Plugins
</a><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/advanced/converters/ class="toc-page dropdown-item text-wrap text-muted">Converters
</a><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/advanced/scripter/ class="toc-page dropdown-item text-wrap text-muted">Scripter
</a><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/advanced/create-locators-links/ class="toc-page dropdown-item text-wrap text-muted">Create Locators from Links
</a><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/advanced/pagination/ class="toc-page dropdown-item text-wrap text-muted">Pagination
</a><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/advanced/appender-encoder/ class="toc-page dropdown-item text-wrap text-muted">Appender and Encoder
</a><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/advanced/dom-loader-selenium-webdriver/ class="toc-page dropdown-item text-wrap text-muted">Dom Loader
</a><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/advanced/ajax-selenium-webdriver/ class="toc-page dropdown-item text-wrap text-muted">Ajax</a></div></div><div class="dropdown show mt-2"><a class="no-collapse-on-click card-link toc-section text-dark" href=#tutorial-scoopi-web-scraper-manage id=dropdownheader data-toggle=collapse aria-haspopup=true aria-expanded=false>Manage</a><div id=tutorial-scoopi-web-scraper-manage class=collapse><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/manage/persistence/ class="toc-page dropdown-item text-wrap text-muted">Persistence
</a><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/manage/split-definitions/ class="toc-page dropdown-item text-wrap text-muted">Split Definitions
</a><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/manage/logs/ class="toc-page dropdown-item text-wrap text-muted">Logs
</a><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/manage/dashboard/ class="toc-page dropdown-item text-wrap text-muted">Dashboard</a></div></div><div class="dropdown show mt-2"><a class="no-collapse-on-click card-link toc-section text-dark" href=#tutorial-scoopi-web-scraper-cluster id=dropdownheader data-toggle=collapse aria-haspopup=true aria-expanded=false>Cluster</a><div id=tutorial-scoopi-web-scraper-cluster><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/cluster/scoopi-cluster-quick-start/ class="toc-page dropdown-item text-wrap text-muted">Quick Start
</a><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/cluster/scoopi-cluster-docker/ class="toc-page dropdown-item text-wrap text-danger">Docker
</a><a href=https://www.codetab.org/tutorial/scoopi-web-scraper/cluster/scoopi-cluster-kubernetes/ class="toc-page dropdown-item text-wrap text-muted">kubernetes</a></div></div></div></div></nav></nav></div></aside><div id=contentbar class=col-md-8><div id=share class="row justify-content-end"><div title=twitter><a href="https://twitter.com/intent/tweet?url=https://www.codetab.org/tutorial/scoopi-web-scraper/cluster/scoopi-cluster-docker/&amp;text=Scoopi%20Cluster%20-%20Scoopi%20Web%20Scraper%20-%20why%20just%20scrape%20when%20you%20can%20scoop" target=_blank rel=noopener><i class="icon-twitter-squared text-secondary"></i></a></div><div title=facebook><a href="https://www.facebook.com/sharer.php?u=https://www.codetab.org/tutorial/scoopi-web-scraper/cluster/scoopi-cluster-docker/&amp;t=Scoopi%20Cluster%20-%20Scoopi%20Web%20Scraper%20-%20why%20just%20scrape%20when%20you%20can%20scoop" target=_blank rel=noopener><i class="icon-facebook-squared text-secondary"></i></a></div><div title=linkedin><a href="https://www.linkedin.com/shareArticle?url=https://www.codetab.org/tutorial/scoopi-web-scraper/cluster/scoopi-cluster-docker/&amp;title=Scoopi%20Cluster%20-%20Scoopi%20Web%20Scraper%20-%20why%20just%20scrape%20when%20you%20can%20scoop" target=_blank rel=noopener><i class="icon-linkedin-squared text-secondary"></i></a></div><div title=email><a href="mailto:?subject=Scoopi%20Cluster%20-%20Scoopi%20Web%20Scraper%20-%20why%20just%20scrape%20when%20you%20can%20scoop&amp;body=https://www.codetab.org/tutorial/scoopi-web-scraper/cluster/scoopi-cluster-docker/" target=_blank rel=noopener><i class="icon-mail-squared text-secondary"></i></a></div><div title=whatsapp><a href="https://web.whatsapp.com/send?text=Scoopi%20Cluster%20-%20Scoopi%20Web%20Scraper%20-%20why%20just%20scrape%20when%20you%20can%20scoop%20https://www.codetab.org/tutorial/scoopi-web-scraper/cluster/scoopi-cluster-docker/" target=_blank rel=noopener><i class="icon-whatsapp text-secondary"></i></a></div><div title=reddit><a href="https://reddit.com/submit?url=https://www.codetab.org/tutorial/scoopi-web-scraper/cluster/scoopi-cluster-docker/&amp;title=Scoopi%20Cluster%20-%20Scoopi%20Web%20Scraper%20-%20why%20just%20scrape%20when%20you%20can%20scoop" target=_blank rel=noopener><i class="icon-reddit-alien text-secondary"></i></a></div><i class="icon-blank ctab-transparent"></i></div><div class=row><main id=content class="col-md-11 post-basic"><h1 id=scoopi-cluster-containers>Scoopi Cluster Containers</h1><p>We can also run Scoopi Cluster as plain Docker containers.</p><h2 id=install-scoopi-from-docker-image>Install Scoopi from Docker Image</h2><p>Scoopi releases are available as docker image from <a href=https://hub.docker.com/r/codetab/scoopi/ target=_blank>DockerHub</a>. To run the image you need <a href=https://docs.docker.com/install/ target=_blank>Docker</a> installed in the system. The following command pulls Scoopi image, creates and run container named scoopi.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-BASH data-lang=BASH><span class=line><span class=cl>docker run --name scoopi codetab/scoopi
</span></span></code></pre></div><p>It executes quick-start example which outputs single record to an output file. However, we will not be able to view the output file nor modify the conf files as they are within the container. We need to externalize these folders with following commands.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-BASH data-lang=BASH><span class=line><span class=cl>mkdir scoopi
</span></span><span class=line><span class=cl><span class=nb>cd</span> scoopi
</span></span><span class=line><span class=cl>docker cp scoopi:/scoopi/conf .
</span></span><span class=line><span class=cl>docker cp scoopi:/scoopi/output .
</span></span><span class=line><span class=cl>docker cp scoopi:/scoopi/docker .
</span></span><span class=line><span class=cl>docker cp scoopi:/scoopi/defs .
</span></span><span class=line><span class=cl>docker cp scoopi:/scoopi/logs .
</span></span></code></pre></div><p>Here, we make a folder named scoopi and then copy conf, output, docker, defs and logs folders from the container to the scoopi folder. Now, we can modify conf, def files and also, view the output file without login into the container. Next, remove the container as we are going to recreate it with a new set of parameters.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-BASH data-lang=BASH><span class=line><span class=cl>docker rm scoopi
</span></span></code></pre></div><p>By default, Scoopi runs in solo mode. Change to cluster mode via <em>scoopi.cluster.enable</em> config in <code>conf/scoopi.properties</code> file. Optionally, change scoopi.defs.dir from quickstart example to ex-13. The <code>scoopi.properties</code> file is in <code>conf</code> directory we have copied above.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-BASH data-lang=BASH><span class=line><span class=cl>
</span></span><span class=line><span class=cl>scoopi.cluster.enable<span class=o>=</span><span class=nb>true</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>scoopi.defs.dir<span class=o>=</span>/defs/examples/fin/jsoup/ex-13
</span></span></code></pre></div><h2 id=docker-compose>Docker Compose</h2><p>It is quite easy to run Scoopi cluster with Docker Compose. The <code>docker</code> folder contains docker-cluster.yml which boots up Scoopi cluster with three servers. Change to folder where you installed scoopi from docker image and run</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-BASH data-lang=BASH><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>cd</span> scoopi
</span></span><span class=line><span class=cl>cp docker/docker-cluster.yml .
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>docker-compose -f docker-cluster.yml up
</span></span></code></pre></div><p>In case docker compose is not available, then we can bring up the cluster with <code>docker run</code> command as explained in next section.</p><h2 id=with-docker-run>With Docker Run</h2><p>Install Scoopi from Docker image and update <code>scoopi.properties</code> as explained above. By default, to form the cluster, we have to run three Scoopi containers. Open terminal and run following command. Wait till Cluster boots up and shows message: <em>wait for cluster quorum of 3 nodes, timeout 60</em>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-BASH data-lang=BASH><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>NODE_NAME</span><span class=o>=</span>scoopi-node-1
</span></span><span class=line><span class=cl><span class=nv>JAVA_OPTS</span><span class=o>=</span><span class=s2>&#34;-Dscoopi.cluster.config.file=/hazelcast-multicast.xml&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>docker run --name <span class=nv>$NODE_NAME</span> -d <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v <span class=nv>$PWD</span>/conf:/scoopi/conf -v <span class=nv>$PWD</span>/defs:/scoopi/defs <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v <span class=nv>$PWD</span>/logs:/scoopi/logs  -v <span class=nv>$outputDir</span>:/scoopi/output <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v <span class=nv>$PWD</span>/data:/scoopi/data <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -e <span class=nv>JAVA_OPTS</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$JAVA_OPTS</span><span class=s2>&#34;</span> codetab/scoopi:latest
</span></span></code></pre></div><p>Next, run above command by changing NODE_NAME to <em>scoopi-node-1</em>. Start the third instance with metrics enabled with following command.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-BASH data-lang=BASH><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>NODE_NAME</span><span class=o>=</span>scoopi-node-3
</span></span><span class=line><span class=cl><span class=nv>JAVA_OPTS</span><span class=o>=</span><span class=s2>&#34;-Dscoopi.cluster.config.file=/hazelcast-multicast.xml&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>JAVA_OPTS</span><span class=o>+=</span><span class=s2>&#34; -Dscoopi.metrics.server.enable=true&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>docker run --name <span class=nv>$NODE_NAME</span> -d <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v <span class=nv>$PWD</span>/conf:/scoopi/conf -v <span class=nv>$PWD</span>/defs:/scoopi/defs <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v <span class=nv>$PWD</span>/logs:/scoopi/logs  -v <span class=nv>$outputDir</span>:/scoopi/output <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v <span class=nv>$PWD</span>/data:/scoopi/data <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -e <span class=nv>JAVA_OPTS</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$JAVA_OPTS</span><span class=s2>&#34;</span> codetab/scoopi:latest
</span></span></code></pre></div><p>Once third instance boots up, cluster is formed and scoopi proceeds and completes the quick start example and the output folder will have scraped data.</p><p>For clients, we need to update <code>conf/hazelcast-client.xml</code> file with the bridge network used by docker containers for connection between them. When you run the server instance, at the startup the IP:Port used by server instance is output in console something like - <em>this member address: /172.17.0.2:5701</em>. Update the network element in <code>conf/hazelcast-client.xml</code> as</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-XML data-lang=XML><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;network&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;cluster-members&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;address&gt;</span>172.17.0.1<span class=nt>&lt;/address&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;address&gt;</span>172.17.0.2<span class=nt>&lt;/address&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;address&gt;</span>172.17.0.3<span class=nt>&lt;/address&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/cluster-members&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/network&gt;</span>
</span></span></code></pre></div><p>The subnet may vary in your system, use the subnet used by your docker bridge network. Now, run client instance with,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-BASH data-lang=BASH><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>NODE_NAME</span><span class=o>=</span>scoopi-node-4
</span></span><span class=line><span class=cl><span class=nv>JAVA_OPTS</span><span class=o>=</span><span class=s2>&#34;-Dscoopi.cluster.mode=client&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>JAVA_OPTS</span><span class=o>+=</span><span class=s2>&#34; -Dscoopi.cluster.config.file=/hazelcast-client.xml&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>docker run --name <span class=nv>$NODE_NAME</span> -d <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v <span class=nv>$PWD</span>/conf:/scoopi/conf -v <span class=nv>$PWD</span>/defs:/scoopi/defs <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v <span class=nv>$PWD</span>/logs:/scoopi/logs  -v <span class=nv>$outputDir</span>:/scoopi/output <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v <span class=nv>$PWD</span>/data:/scoopi/data <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -e <span class=nv>JAVA_OPTS</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$JAVA_OPTS</span><span class=s2>&#34;</span> codetab/scoopi:latest
</span></span></code></pre></div><p>For more about configuring the hazelcast network in various scenarios refer <a href=https://hazelcast.org/blog/configuring-hazelcast-in-non-orchestrated-docker-environments/ target=_blank>Configuring Hazelcast in non-orchestrated Docker environments</a>.</p></main></div></div><aside id=sidebar-right class=col-md-1><div class="row my-5 justify-content-center"></div></aside></div></div><footer class="container-fluid mt-5"><div class=row><div class="col ml-auto"><div class="row mb-1 ml-2"><a class=text-muted href=/privacy-policy>Privacy</a></div><div class="row text-muted mb-2 ml-2"><span>&copy; 2019 &#183;Powered by <a href=https://gohugo.io target=_blank rel=noopener>Hugo</a></span></div></div><div class="col mr-auto"><span class=float-right><a href=# id=back_to_top><i class="icon-up-open h1 text-secondary"></i></a></span></div></div></footer><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script src=/js/vendor.min.c32ad1c7e87da9243fe3a4ff30c9040737545641e3a0a16a1cde4d62759f9fea.js></script></body></html>