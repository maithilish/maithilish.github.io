<!DOCTYPE html>
<html lang="en-us">

<head><meta charset="utf-8">
<meta name="description" content="With persistence, Scoopi Web Scraper offers following benefits - reduce downloads, recover from the aborted run, avoid expensive parse operation">
<meta name="author" content="Maithilish">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">



<script async src="https://www.googletagmanager.com/gtag/js?id=UA-42139846-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-42139846-3');
</script>

<script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "https://www.codetab.org/"
        },
        "articleSection" : "tutorial",
        "name" : "Persistence - Scoopi Web Scraper - why just scrape when you can scoop",
        "headline" : "Persistence - Scoopi Web Scraper - why just scrape when you can scoop",
        "description" : "With persistence, Scoopi Web Scraper offers following benefits - reduce downloads, recover from the aborted run, avoid expensive parse operation",
        "inLanguage" : "en",
        "author" : "Maithilish",
        "creator" : "Maithilish",
        "publisher": "Maithilish",
        "copyrightHolder" : "Maithilish",
        "copyrightYear" : "2019",
        "datePublished": "2019-01-12 01:02:00 +0530 IST",
        "dateModified" : "2019-01-12 01:02:00 +0530 IST",
        "url" : "/tutorial/scoopi-web-scraper/manage/persistence/",
        "wordCount" : "537",
        "keywords" : [ "persistence","Blog" ]
    }
</script>
<link rel="icon" href="/favicon.ico">






<link rel="stylesheet" href="/css/vendor.min.06af1451a3c5b3b70a0c0bd7be26092e20e9c31251c08d44dbe1486a9a2a414c.css" integrity="sha256-Bq8UUaPFs7cKDAvXviYJLiDpwxJRwI1E2&#43;FIapoqQUw=">

<title>Persistence - Scoopi Web Scraper - why just scrape when you can scoop</title></head>

<body id="top"><header><nav id="navbar-main" class="navbar fixed-top navbar-light navbar-expand-lg bg-white border-bottom shadow-sm">

    <div class="container-fluid">

        
        <a class="navbar-brand" href="/">Codetab</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbar"
            aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        
        <div class="collapse navbar-collapse" id="navbar">

            
            
            <ul class="navbar-nav ml-auto">
                

                

                
                
                
                
                

                <li class="nav-item">
                    <a class="nav-link" href="/#tutorials"  >
                        
                        <span>Home</span>
                        
                    </a>
                </li>

                
                

                

                
                
                
                
                

                <li class="nav-item">
                    <a class="nav-link" href="/#projects"  >
                        
                        <span>Projects</span>
                        
                    </a>
                </li>

                
                

                

                
                
                

                <li class="nav-item">
                    <a class="nav-link" href="/post"  >
                        
                        <span>Posts</span>
                        
                    </a>
                </li>

                
                

                

                
                
                
                
                

                <li class="nav-item">
                    <a class="nav-link" href="/#about"  >
                        
                        <span>About</span>
                        
                    </a>
                </li>

                
                

            </ul>

        </div>
    </div>
</nav></header>

<div class="container-fluid">
  <div class="row">&nbsp;</div>
  <div class="row">
    <aside id="sidebar" class="col-md-4">
      <div class="row"><nav id="navbar-side" class="bg-light text-secondary">
        
    
    

    

    
    

    

    <h4 class="text-muted bg-white pl-2">Scoopi Web Scraper</h4>

    <nav class="navbar navbar-light bg-white navbar-expand-md">

        <button class="navbar-toggler ml-auto" type="button" data-toggle="collapse" data-target="#bookmenu"
            aria-controls="bookmenu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bookmenu">
            <div>
                
                









<div id="Scoopi Web Scraper">
    
    <div>
        <a href="https://www.codetab.org/tutorial/scoopi-web-scraper/introduction/" class="toc-page text-muted ">
            Introduction
        </a>
    </div>
    
</div>







<div class="dropdown show mt-2">
    <a class="no-collapse-on-click card-link toc-section text-dark" href="#tutorial-scoopi-web-scraper-basic" id="dropdownheader"
        data-toggle="collapse" aria-haspopup="true" aria-expanded="false">
        Basics
    </a>
    
    <div id="tutorial-scoopi-web-scraper-basic" class="collapse">
        
        
        <a href="https://www.codetab.org/tutorial/scoopi-web-scraper/basic/installation-quick-start/" class="toc-page dropdown-item text-muted">
            Installation and Quick Start
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/scoopi-web-scraper/basic/definition-file/" class="toc-page dropdown-item text-muted">
            Definition File
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/scoopi-web-scraper/basic/datadef/" class="toc-page dropdown-item text-muted">
            DataDef
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/scoopi-web-scraper/basic/dimensions/" class="toc-page dropdown-item text-muted">
            Dimensions
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/scoopi-web-scraper/basic/data-items-dynamic-query/" class="toc-page dropdown-item text-muted">
            Data Items and Dynamic Query
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/scoopi-web-scraper/basic/index-indexrange-breakafter/" class="toc-page dropdown-item text-muted">
            Index, IndexRange and BreakAfter
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/scoopi-web-scraper/basic/filters/" class="toc-page dropdown-item text-muted">
            Filters
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/scoopi-web-scraper/basic/selector-query-analyzer/" class="toc-page dropdown-item text-muted">
            Selector
        </a>
        
        
        
        
    </div>
</div>




<div class="dropdown show mt-2">
    <a class="no-collapse-on-click card-link toc-section text-dark" href="#tutorial-scoopi-web-scraper-advanced" id="dropdownheader"
        data-toggle="collapse" aria-haspopup="true" aria-expanded="false">
        Advanced
    </a>
    
    <div id="tutorial-scoopi-web-scraper-advanced" class="collapse">
        
        
        <a href="https://www.codetab.org/tutorial/scoopi-web-scraper/advanced/multi-dimensions/" class="toc-page dropdown-item text-muted">
            Multi Dimensions
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/scoopi-web-scraper/advanced/multi-tasks/" class="toc-page dropdown-item text-muted">
            Multi Tasks
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/scoopi-web-scraper/advanced/workflow-steps-plugins/" class="toc-page dropdown-item text-muted">
            WorkFlow, Steps and Plugins
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/scoopi-web-scraper/advanced/converters/" class="toc-page dropdown-item text-muted">
            Converters
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/scoopi-web-scraper/advanced/scripter/" class="toc-page dropdown-item text-muted">
            Scripter
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/scoopi-web-scraper/advanced/create-locators-links/" class="toc-page dropdown-item text-muted">
            Create Locators from Links
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/scoopi-web-scraper/advanced/pagination/" class="toc-page dropdown-item text-muted">
            Pagination
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/scoopi-web-scraper/advanced/appender-encoder/" class="toc-page dropdown-item text-muted">
            Appender and Encoder
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/scoopi-web-scraper/advanced/dom-loader-selenium-webdriver/" class="toc-page dropdown-item text-muted">
            Dom Loader
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/scoopi-web-scraper/advanced/ajax-selenium-webdriver/" class="toc-page dropdown-item text-muted">
            Ajax
        </a>
        
        
        
        
    </div>
</div>




<div class="dropdown show mt-2">
    <a class="no-collapse-on-click card-link toc-section text-dark" href="#tutorial-scoopi-web-scraper-manage" id="dropdownheader"
        data-toggle="collapse" aria-haspopup="true" aria-expanded="false">
        Manage
    </a>
    
    <div id="tutorial-scoopi-web-scraper-manage" class="">
        
        
        <a href="https://www.codetab.org/tutorial/scoopi-web-scraper/manage/persistence/" class="toc-page dropdown-item text-danger">
            Persistence
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/scoopi-web-scraper/manage/split-definitions/" class="toc-page dropdown-item text-muted">
            Split Definitions
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/scoopi-web-scraper/manage/logs/" class="toc-page dropdown-item text-muted">
            Logs
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/scoopi-web-scraper/manage/dashboard/" class="toc-page dropdown-item text-muted">
            Dashboard
        </a>
        
        
        <a href="https://www.codetab.org/tutorial/scoopi-web-scraper/manage/db-setup/" class="toc-page dropdown-item text-muted">
            DB Setup
        </a>
        
        
        
        
    </div>
</div>



                
            </div>
        </div>
    </nav>

</nav>

</div>
      <div class="row my-5 justify-content-center">
<div>&nbsp;</div>


<ins class="adsbygoogle"
     style="display:inline-block;width:160px;height:600px"
     data-ad-client="ca-pub-1281079745125126"
     data-ad-slot="8963022093"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<div>&nbsp;</div>
</div>
    </aside>
    <div id="contentbar" class="col-md-8">
      <div id="share" class="row justify-content-end">





<div title=twitter>
    <a href="https://twitter.com/intent/tweet?url=https://www.codetab.org/tutorial/scoopi-web-scraper/manage/persistence/&amp;text=Persistence%20-%20Scoopi%20Web%20Scraper%20-%20why%20just%20scrape%20when%20you%20can%20scoop" target="_blank" rel="noopener">
        <i class="icon-twitter-squared text-secondary"></i>
    </a>
</div>




<div title=facebook>
    <a href="https://www.facebook.com/sharer.php?u=https://www.codetab.org/tutorial/scoopi-web-scraper/manage/persistence/&amp;t=Persistence%20-%20Scoopi%20Web%20Scraper%20-%20why%20just%20scrape%20when%20you%20can%20scoop" target="_blank" rel="noopener">
        <i class="icon-facebook-squared text-secondary"></i>
    </a>
</div>




<div title=linkedin>
    <a href="https://www.linkedin.com/shareArticle?url=https://www.codetab.org/tutorial/scoopi-web-scraper/manage/persistence/&amp;title=Persistence%20-%20Scoopi%20Web%20Scraper%20-%20why%20just%20scrape%20when%20you%20can%20scoop" target="_blank" rel="noopener">
        <i class="icon-linkedin-squared text-secondary"></i>
    </a>
</div>




<div title=email>
    <a href="mailto:?subject=Persistence%20-%20Scoopi%20Web%20Scraper%20-%20why%20just%20scrape%20when%20you%20can%20scoop&amp;body=https://www.codetab.org/tutorial/scoopi-web-scraper/manage/persistence/" target="_blank" rel="noopener">
        <i class="icon-mail-squared text-secondary"></i>
    </a>
</div>




<div title=whatsapp>
    <a href="https://web.whatsapp.com/send?text=Persistence%20-%20Scoopi%20Web%20Scraper%20-%20why%20just%20scrape%20when%20you%20can%20scoop%20https://www.codetab.org/tutorial/scoopi-web-scraper/manage/persistence/" target="_blank" rel="noopener">
        <i class="icon-whatsapp text-secondary"></i>
    </a>
</div>




<div title=reddit>
    <a href="https://reddit.com/submit?url=https://www.codetab.org/tutorial/scoopi-web-scraper/manage/persistence/&amp;title=Persistence%20-%20Scoopi%20Web%20Scraper%20-%20why%20just%20scrape%20when%20you%20can%20scoop" target="_blank" rel="noopener">
        <i class="icon-reddit-alien text-secondary"></i>
    </a>
</div>




<div title=weibo>
    <a href="https://service.weibo.com/share/share.php?url=https://www.codetab.org/tutorial/scoopi-web-scraper/manage/persistence/&amp;title=Persistence%20-%20Scoopi%20Web%20Scraper%20-%20why%20just%20scrape%20when%20you%20can%20scoop" target="_blank" rel="noopener">
        <i class="icon-weibo text-secondary"></i>
    </a>
</div>




<i class="icon-blank ctab-transparent"></i></div>
      <div class="row">
        <main id="content" class="col-md-11 post-basic">
          

<h1 id="persistence">Persistence</h1>

<p>With persistence, Scoopi offers following benefits.</p>

<ul>
<li>reduce network usage by reusing the downloaded pages</li>
<li>recover from the aborted run by skipping the tasks already completed</li>
<li>avoid expensive parse operation by reuse of persisted data</li>
<li>set expiry date for each page</li>
</ul>

<h2 id="setup-database">Setup Database</h2>

<p>If you running Scoopi from docker image then no database setup is
required as docker image contains pre-configured MariaDB container.
Please refer <a href="/tutorial/scoopi-web-scraper/basic/installation-quick-start/">Scoopi Installation</a> to run Scoopi with MariaDB using docker-compose.</p>

<p>In case you are using release package from GitHub to run Scoopi, then
you have to set up MariaDB or HSQLDB database manually. See <a href="/tutorial/scoopi-web-scraper/manage/db-setup/">HSQLDB
Setup</a> to setup and configure Hsql
database.</p>

<h2 id="enable-persistence-in-scoopi">Enable Persistence in Scoopi</h2>

<p>By default persistence is disabled in Scoopi through configuration
setting <em>scoopi.useDatastore=false</em> in <code>conf/scoopi.properties</code> file. To
enable persistence, either set the property <em>scoopi.useDatastore=true</em>
or hash it out.</p>

<p>Now run <a href="https://github.com/maithilish/scoopi/blob/master/src/main/resources/defs/examples/fin/jsoup/ex-10/job.yml" target="_blank">Example 10</a> and scoopi database should have locator, datadef, data and document tables with data.</p>

<h2 id="live">Live</h2>

<p>When we first run Example-10 with persistence enabled, <em>document table</em>
which holds compressed contents of the pages - acme-snapshot-links.html,
acme-bs.html and acme-pl.html will end up with three rows and <em>data
table</em> which holds the parsed data will have five rows - finLinks,
price, snapshot, bs and pl.</p>

<p>If we run Scoopi again and query the tables, the document table will
have 6 rows and data table will end up with 10 rows. For each run,
Scoopi fetches fresh pages and parse it to create data even though
persistence is enabled. This is because, by default, <em>live</em> setting
which controls the expiry of page is set to zero days (P0D). So, in each
run, Scoopi sees page as expired and fetches new one. Use live property
in tasks group to alter this default behavior.</p>

<p>Suppose, we want to fetch new snapshot page once in a week. The
<a href="https://github.com/maithilish/scoopi/blob/master/src/main/resources/defs/examples/fin/jsoup/ex-11/job.yml" target="_blank">Example 11</a>
sets live property to P1W for snapshotGroup as shown below</p>
<div class="highlight"><pre class="chroma"><code class="language-raw" data-lang="raw">taskGroups:
  snapshotGroup:
    priceTask:
      dataDef: price

    snapshotTask:
      dataDef: snapshot        

    live: P1W</code></pre></div>
<p>The P0D, P1W are
<a href="https://en.wikipedia.org/wiki/ISO_8601#Durations" target="_blank">ISO_8601</a> based
representation of duration.</p>

<p>During initial run, Scoopi fetches fresh pages and persists. In
subsequent runs, it reuses the persisted page and data till pages are
expired. This speeds up the run by many fold.</p>

<h2 id="persist-control">Persist Control</h2>

<p>We can further control persistence of locator or data using persist
property.</p>

<p>In <code>conf/scoopi.properties</code> we can set following properties</p>

<pre><code>scoopi.useDatastore=true|false

scoopi.persist.locator=true|false
scoopi.persist.data=true|false
</code></pre>

<p>If scoopi.useDatastore is false then there is no need to start database
as nothing is stored. If scoopi.useDatastore is true, then</p>

<ul>
<li>if scoopi.persist.locator is false then no locator and its documents
are stored</li>
<li>if scoopi.persist.data is false then no data is stored</li>
</ul>

<p>If scoopi.persist.data is true, then in addition, we can control whether
to persist data of each task using <em>persist/data</em> property in task
definition. The
<a href="https://github.com/maithilish/scoopi/blob/master/src/main/resources/defs/examples/fin/jsoup/ex-12/job.yml" target="_blank">Example 12</a></p>
<div class="highlight"><pre class="chroma"><code class="language-raw" data-lang="raw">taskGroups:
  snapshotGroup:

    priceTask:
      dataDef: price      
      persist:
        data: true

    snapshotTask:
      dataDef: snapshot
      persist:
        data: false

    live: P1W</code></pre></div>
<p>The data parsed by priceTask are stored but not the snapshotTask as
persist/data is false for that task.</p>

<h2 id="use-scoopi-with-other-databases">Use Scoopi with other Databases</h2>

<p>Scoopi uses <a href="https://db.apache.org/jdo/" target="_blank">JDO</a> and <a href="http://www.datanucleus.org/" target="_blank">DataNucleus
AccessPlatform</a> which works with variety of
databases. Scoopi is tested with MySQL, MariaDB and MongoDB and
configuration for each of them is in <code>conf/jdoconfig.properties</code> file.</p>

<p>The next chapter describes spliting the lengthy defintions into multiple
files for easy maintainance.</p>

        </main>
        <aside id="sidebar-right" class="col-md-1">
        </aside>
      </div>
    </div>
  </div>
</div>

<footer class="container-fluid mt-5">

    <div class="row">
        <div class="col ml-auto">
            <div class="row mb-1 ml-2">
                <a class="text-muted" href="/privacy-policy">Privacy</a>
            </div>
            <div class="row text-muted mb-2 ml-2">
                <span>&copy; 2019 &middot;Powered by <a href="https://gohugo.io" target="_blank"
                        rel="noopener">Hugo</a></span>
            </div>
        </div>
        <div class="col mr-auto">
            <span class="float-right">
                <a href="#" id="back_to_top">
                    <i class="icon-up-open h1 text-secondary"></i>
                </a>
            </span>
        </div>
    </div>

</footer>

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>








<script src="/js/vendor.min.d5750c855207aebcf4fdb7568961a27500008ef4a4f40b63a7b028f80a9221d3.js"></script>
</body>

</html>